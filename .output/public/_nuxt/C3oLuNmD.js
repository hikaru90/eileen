import{_ as W}from"./DR3C1UCQ.js";import{f as q,u as pe,l as S,r as U,m as fe,o as u,c as d,a,n as e,C as Y,b,v as F,t as N,F as M,x as A,z as B,d as I,U as ve,R as we,O as xe,N as ne,I as he,Q as De,A as Q,V as Te,W as K,X as ke,E as $e,Y as Ve,p as Se,e as Ie,w as J,q as Me,B as ae}from"./BtqrO9Ir.js";import{d as oe}from"./F1WjrixK.js";import{_ as ge}from"./DlAUqK2U.js";const Oe={class:"flex flex-col lg:flex-row gap-10 mb-36"},Ce={class:"w-full lg:w-1/2"},Ne={class:"flex items-center justify-between mb-2"},Fe={style:{width:"14.285%"},class:"flex items-center justify-center"},Ee={style:{width:"14.285%"},class:"flex items-center justify-center"},je={class:"weekdays flex justify-start mb-2"},Be={class:"flex flex-wrap justify-start"},Ae={class:"w-full aspect-square flex items-center justify-center"},qe=["onClick"],Le={key:1,class:"w-full aspect-square flex items-center justify-center"},Ue={class:"w-full lg:w-1/2"},Pe={key:0,class:"text-md mb-10 mt-6"},ze=a("br",null,null,-1),He=a("br",null,null,-1),Re={class:""},Qe={class:"mb-3"},We={class:""},Ge={class:"flex items-center flex-wrap gap-2"},Je=["onClick"],Ze=q({__name:"BookingCalendarDate",props:{component:{default:{content:oe.find(o=>o.type==="bookingCalendar").content}},selectedTimeslot:{}},emits:["selectTimeslot"],setup(o,{emit:c}){const{pb:t}=pe(),g=c,r=o,k=["Mo","Di","Mi","Do","Fr","Sa","So"],n=(p,$)=>new Date(p,$+1,0).getDate(),h=(p,$)=>(new Date(p,$,1).getDay()+7-1)%7,w=(p,$,x)=>new Date(p,$,x).getDay(),f=()=>{C.value<l.maxMonth&&(l.month<11?l.month++:(l.month=0,l.year++))},m=()=>{C.value>l.minMonth&&(l.month>0?l.month--:(l.month=11,l.year--))},v=(p,$)=>{const x=new Date(p);return x.setDate(x.getDate()+$),x},s=(p,$)=>{const x=new Date(p);return x.setMonth(x.getMonth()+$),x},i=p=>p===6||p===0,_=(p,$,x)=>{const D=new Date().setHours(0,0,0,0),E=new Date(v(D,5)).setHours(0,0,0,0);return new Date(p,$,x).setHours(0,0,0,0)<E},T=S(()=>{const p=n(l.year,l.month);return Array.from(Array(p).keys()).map(x=>x+1).map(x=>{const D=w(l.year,l.month,x);return{date:x,weekday:D,isDisabled:i(D)||_(l.year,l.month,x)}})}),O=S(()=>h(l.year,l.month)),V=S(()=>{let p=l.month,$=l.year;p>0?p--:(p=11,$--);const x=Array.from(Array(n($,p)).keys()).map(D=>D+1);if(O.value===0)return[];{const D=-1*O.value;return x.slice(D)}}),l=U({step:1,minMonth:Number(new Date().toISOString().split("-").slice(0,2).join("")),maxMonth:Number(s(new Date,3).toISOString().split("-").slice(0,2).join("")),today:new Date,month:new Date().getMonth(),year:new Date().getFullYear(),selectedDate:void 0,appointmentsOfTheDay:[],timeslots:[]}),C=S(()=>Number(new Date(l.year,l.month+1).toISOString().split("-").slice(0,2).join("")));S(()=>{const p=new Date(l.minMonth).getMonth(),$=new Date(l.maxMonth).getMonth()+3;return p<$});const y=async p=>{l.selectedDate=new Date(l.year,l.month,p).setHours(0,0,0,0),await se(),await le()},P=S(()=>String(l.month+1).padStart(2,"0")),z=S(()=>String(new Date(l.selectedDate).getDate()).padStart(2,"0")),se=async()=>{const p=`start <= "${l.year}-${P.value}-${z.value} 23:59:59" && end >= "${l.year}-${P.value}-${z.value} 00:00:00"`,$=await t.collection("bookings").getFullList(200,{filter:p});l.appointmentsOfTheDay=$},ye=(p,$)=>{let x=[];const D=new Date(`${l.year}-${P.value}-${z.value} `+p),E=new Date(`${l.year}-${P.value}-${z.value} `+$);let j=D;for(;j<=E;){console.log("currentTime.toLocaleTimeString()",j.toLocaleTimeString());const G=j.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(l.appointmentsOfTheDay.length>0){let H=[];for(const L of l.appointmentsOfTheDay){let R=new Date(new Date(L.start).getTime()+new Date(L.start).getTimezoneOffset()*6e4);R.setMinutes(R.getMinutes()-80);const Z=new Date(new Date(L.end).getTime()+new Date(L.end).getTimezoneOffset()*6e4);Z.setMinutes(Z.getMinutes()+30),console.log("appointmentStart",R.toLocaleTimeString()," || appointmentEnd",Z.toLocaleTimeString()),j>=R&&j<Z?H.push(1):H.push(0)}H.reduce((L,R)=>L+R,0)===0&&x.push(G)}else x.push(G);j.setMinutes(j.getMinutes()+30)}return x},le=()=>{const p=r.component.content.days.find($=>$.id===new Date(l.selectedDate).getDay());l.timeslots=ye(p==null?void 0:p.startTime,p==null?void 0:p.endTime)};return fe(async()=>{await se(),await le()}),(p,$)=>{const x=W;return u(),d("div",Oe,[a("div",Ce,[a("div",Ne,[a("div",Fe,[e(C)>e(l).minMonth?(u(),d("button",{key:0,"aria-label":"Monat zurück",onClick:Y(m,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[b(x,{name:"icon-caret-left",class:"text-xl"})])):F("",!0)]),a("div",null,N(new Date(e(l).year,e(l).month).toLocaleString("de-DE",{month:"long"})),1),a("div",Ee,[e(C)<e(l).maxMonth?(u(),d("button",{key:0,"aria-label":"Monat vor",onClick:Y(f,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[b(x,{name:"icon-caret-right",class:"text-xl"})])):F("",!0)])]),a("div",je,[(u(),d(M,null,A(k,(D,E)=>a("div",{key:"weekday"+E,style:{width:"14.285%"},class:"flex items-center justify-center text-lightGrey text-opacity-60"},N(D),1)),64))]),a("div",Be,[(u(!0),d(M,null,A(e(V),(D,E)=>(u(),d("div",{key:"offset"+E,style:{width:"14.285%"},class:"offsets text-lightGrey text-opacity-60 flex items-center justify-center flex-shrink-0"},[a("div",Ae,N(D),1)]))),128)),(u(!0),d(M,null,A(e(T),(D,E)=>(u(),d("div",{key:"day"+E,style:{width:"14.285%"},class:B([[D.isDisabled?"text-lightGrey text-opacity-60":""],"flex items-center justify-center flex-shrink-0 p-1"])},[D.isDisabled?(u(),d("div",Le,N(D.date),1)):(u(),d("button",{key:0,"aria-label":"Tag auswählen",onClick:Y(j=>y(D.date),["stop"]),class:B(["hover:border hover:border-gold rounded-full w-full aspect-square",[e(l).selectedDate===new Date(e(l).year,e(l).month,D.date).setHours(0,0,0,0)?"bg-gold":""]])},N(D.date),11,qe))],2))),128))])]),a("div",Ue,[e(l).selectedDate?(u(),d(M,{key:1},[e(l).timeslots.length===0?(u(),d(M,{key:0},[I(" Am "),a("span",Re,N(new Date(e(l).selectedDate).toLocaleDateString("de-DE",{})),1),I(" stehen Dir leider keine freien Termine zur Verfügung. ")],64)):(u(),d(M,{key:1},[a("div",Qe,[I(" Am "),a("span",We,N(new Date(e(l).selectedDate).toLocaleDateString("de-DE",{})),1),I(" stehen Dir folgende Termine zur Verfügung: ")]),a("div",Ge,[(u(!0),d(M,null,A(e(l).timeslots,(D,E)=>{var j,G,H;return u(),d("button",{"aria-label":"Zeitslot auswählen",onClick:L=>g("selectTimeslot",{year:e(l).year,month:e(P),day:e(z),timeslot:D}),key:"timeslot"+E,class:B([[((j=r.selectedTimeslot)==null?void 0:j.month)===e(P)&&((G=r.selectedTimeslot)==null?void 0:G.day)===e(z)&&((H=r.selectedTimeslot)==null?void 0:H.timeslot)===D?"bg-gold":"hover:bg-gold"],"border border-gold rounded px-1 py-1 w-14 flex items-center justify-center"])},N(D),11,Je)}),128))])],64))],64)):(u(),d("h2",Pe,[I(" Hier kannst Du ganz bequem über das Online Buchungstool einen Erst- oder Folgetermin buchen."),ze,He,I(" Wähle dafür ein Datum und eine passende Uhrzeit aus. ")]))])])}}}),Ye={},Ke={class:"w-full flex items-center px-4"},Xe={class:"mr-2"},et=a("div",{class:"border-b border-sand flex-grow"},null,-1);function tt(o,c){return u(),d("div",Ke,[a("h2",Xe,[ve(o.$slots,"default")]),et])}const nt=ge(Ye,[["render",tt]]),X=q({__name:"InputLabel",props:{label:{}},setup(o){const c=o;return(t,g)=>(u(),d("div",{class:B(["text-xs ml-2",[{"mb-1":c.label}]])},N(c.label),3))}}),ot={class:"bg-red bg-opacity-40 text-red text-sm mt-1 px-1 py-[2px] rounded"},ee=q({__name:"InputError",props:{error:{}},setup(o){const c=o;return(t,g)=>(u(),d("div",ot,N(c.error),1))}});var ie;const _e=typeof window<"u",st=o=>typeof o<"u",lt=o=>typeof o=="function",at=o=>typeof o=="string",it=()=>{};_e&&((ie=window==null?void 0:window.navigator)!=null&&ie.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function be(o){return typeof o=="function"?o():e(o)}function rt(o){return o}function ut(o){return we()?(xe(o),!0):!1}function dt(o){var c;const t=be(o);return(c=t==null?void 0:t.$el)!=null?c:t}const ct=_e?window:void 0;function mt(...o){let c,t,g,r;if(at(o[0])||Array.isArray(o[0])?([t,g,r]=o,c=ct):[c,t,g,r]=o,!c)return it;Array.isArray(t)||(t=[t]),Array.isArray(g)||(g=[g]);const k=[],n=()=>{k.forEach(m=>m()),k.length=0},h=(m,v,s,i)=>(m.addEventListener(v,s,i),()=>m.removeEventListener(v,s,i)),w=ne(()=>[dt(c),be(r)],([m,v])=>{n(),m&&k.push(...t.flatMap(s=>g.map(i=>h(m,s,i,v))))},{immediate:!0,flush:"post"}),f=()=>{w(),n()};return ut(f),f}function pt(o){return JSON.parse(JSON.stringify(o))}const re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ue="__vueuse_ssr_handlers__";re[ue]=re[ue]||{};var de;(function(o){o.UP="UP",o.RIGHT="RIGHT",o.DOWN="DOWN",o.LEFT="LEFT",o.NONE="NONE"})(de||(de={}));var ft=Object.defineProperty,ce=Object.getOwnPropertySymbols,vt=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable,me=(o,c,t)=>c in o?ft(o,c,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[c]=t,gt=(o,c)=>{for(var t in c||(c={}))vt.call(c,t)&&me(o,t,c[t]);if(ce)for(var t of ce(c))ht.call(c,t)&&me(o,t,c[t]);return o};const _t={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};gt({linear:rt},_t);function te(o,c,t,g={}){var r,k,n;const{clone:h=!1,passive:w=!1,eventName:f,deep:m=!1,defaultValue:v}=g,s=De(),i=t||(s==null?void 0:s.emit)||((r=s==null?void 0:s.$emit)==null?void 0:r.bind(s))||((n=(k=s==null?void 0:s.proxy)==null?void 0:k.$emit)==null?void 0:n.bind(s==null?void 0:s.proxy));let _=f;_=f||_||`update:${c.toString()}`;const T=V=>h?lt(h)?h(V):pt(V):V,O=()=>st(o[c])?T(o[c]):v;if(w){const V=O(),l=he(V);return ne(()=>o[c],C=>l.value=T(C)),ne(l,C=>{(C!==o[c]||m)&&i(_,C)},{deep:m}),l}else return S({get(){return O()},set(V){i(_,V)}})}const bt={class:"relative"},yt={class:"w-full relative"},wt=["type","placeholder"],xt={class:"absolute top-1/2 right-2 transform -translate-y-1/2"},Dt={key:0,class:"bg-green bg-opacity-40 rounded"},Tt={key:1,class:"bg-red bg-opacity-40 rounded"},kt=q({__name:"Input",props:{modelValue:{},label:{},innerClass:{},inputClass:{default:"pl-2 pr-10 py-1 w-full border border-grey rounded"},placeholder:{},validation:{},type:{default:"text"}},emits:["update:modelValue","update"],setup(o,{emit:c}){const t=o,g=U({touched:!1}),r=S(()=>{if(g.touched)return!(k.value.length>0)}),k=S(()=>{var m,v,s;let f=[];return g.touched&&((m=t.validation)!=null&&m.includes("required")&&(t.modelValue||f.push("Dieses Feld ist ein Pflichtfeld")),(v=t.validation)!=null&&v.includes("email")&&((s=t.modelValue)==null?void 0:s.includes("@"))===!1&&f.push("Bitte gib eine gültige E-Mail-Adresse ein")),f}),n=()=>{g.touched=!0,h("update")},h=c,w=te(t,"modelValue",h);return(f,m)=>{const v=X,s=W,i=ee;return u(),d("div",{class:B(f.innerClass)},[a("div",bt,[b(v,{label:t.label,class:"text-left"},null,8,["label"]),a("div",yt,[Q(a("input",{autocomplete:"disabled",type:f.type,placeholder:f.placeholder,class:B([t.inputClass,"fieldTarget"]),"onUpdate:modelValue":m[0]||(m[0]=_=>K(w)?w.value=_:null),onBlur:n},null,42,wt),[[Te,e(w)]]),a("div",xt,[e(r)?(u(),d("div",Dt,[b(s,{name:"icon-check",class:"text-green text-xl"})])):F("",!0),e(r)===!1?(u(),d("div",Tt,[b(s,{name:"icon-cross",class:"text-red text-xl"})])):F("",!0)])]),e(r)?F("",!0):(u(!0),d(M,{key:0},A(e(k),(_,T)=>(u(),d("div",{key:"error"+T},[b(i,{error:_},null,8,["error"])]))),128))])],2)}}}),$t={class:"relative"},Vt={class:"w-full relative"},St=["value","selected"],It={class:"absolute top-1/2 right-5 transform -translate-y-1/2"},Mt={key:0,class:"bg-green bg-opacity-40 rounded"},Ot={key:1,class:"bg-red bg-opacity-40 rounded"},Ct=q({__name:"InputSelect",props:{modelValue:{},label:{},options:{},innerClass:{},validation:{}},emits:["update:modelValue","update"],setup(o,{emit:c}){const t=o,g=c,r=te(t,"modelValue",g),k=U({touched:!1}),n=S(()=>{if(k.touched)return!(h.value.length>0)}),h=S(()=>{var m;let f=[];return k.touched&&(m=t.validation)!=null&&m.includes("required")&&(t.modelValue||f.push("Wähle bitte eine Option")),f}),w=()=>{k.touched=!0,g("update")};return(f,m)=>{const v=X,s=W,i=ee;return u(),d("div",{class:B(f.innerClass)},[a("div",$t,[b(v,{label:t.label,class:"text-left"},null,8,["label"]),a("div",Vt,[Q(a("select",{onBlur:w,"onUpdate:modelValue":m[0]||(m[0]=_=>K(r)?r.value=_:null),onInput:m[1]||(m[1]=_=>g("update")),class:"fieldTarget w-full border border-grey rounded pl-2 pr-8 py-[6px]"},[(u(!0),d(M,null,A(t.options,(_,T)=>(u(),d("option",{key:"option"+T,value:_.value,selected:_.value===e(r)},N(_.label),9,St))),128))],544),[[ke,e(r)]]),a("div",It,[e(n)?(u(),d("div",Mt,[b(s,{name:"icon-check",class:"text-green text-xl"})])):F("",!0),e(n)===!1?(u(),d("div",Ot,[b(s,{name:"icon-cross",class:"text-red text-xl"})])):F("",!0)])]),e(n)?F("",!0):(u(!0),d(M,{key:0},A(e(h),(_,T)=>(u(),d("div",{key:"error"+T},[b(i,{error:_},null,8,["error"])]))),128))])],2)}}}),Nt={class:"relative"},Ft={class:"w-full relative"},Et=["type","placeholder"],jt={class:"absolute top-2 right-2"},Bt={key:0,class:"bg-green bg-opacity-40 rounded"},At={key:1,class:"bg-red bg-opacity-40 rounded"},qt=q({__name:"InputTextarea",props:{modelValue:{},label:{},innerClass:{},placeholder:{},validation:{},type:{default:"textarea"}},emits:["update:modelValue","update"],setup(o,{emit:c}){const t=o,g=U({touched:!1}),r=S(()=>{if(g.touched)return!(k.value.length>0)}),k=S(()=>{var m,v,s;let f=[];return g.touched&&((m=t.validation)!=null&&m.includes("required")&&(t.modelValue||f.push("Dieses Feld ist ein Pflichtfeld")),(v=t.validation)!=null&&v.includes("email")&&((s=t.modelValue)==null?void 0:s.includes("@"))===!1&&f.push("Bitte gib eine gültige E-Mail-Adresse ein")),f}),n=()=>{g.touched=!0,h("update")},h=c,w=te(t,"modelValue",h);return(f,m)=>{const v=X,s=W,i=ee;return u(),d("div",{class:B(f.innerClass)},[a("div",Nt,[b(v,{label:t.label,class:"text-left"},null,8,["label"]),a("div",Ft,[Q(a("textarea",{autocomplete:"disabled",type:f.type,placeholder:f.placeholder,"onUpdate:modelValue":m[0]||(m[0]=_=>K(w)?w.value=_:null),onBlur:n,class:"fieldTarget w-full p-2 border border-grey rounded"},null,40,Et),[[$e,e(w)]]),a("div",jt,[e(r)?(u(),d("div",Bt,[b(s,{name:"icon-check",class:"text-green text-xl"})])):F("",!0),e(r)===!1?(u(),d("div",At,[b(s,{name:"icon-cross",class:"text-red text-xl"})])):F("",!0)])]),e(r)?F("",!0):(u(!0),d(M,{key:0},A(e(k),(_,T)=>(u(),d("div",{key:"error"+T},[b(i,{error:_},null,8,["error"])]))),128))])],2)}}}),Lt=o=>(Se("data-v-0c5b6ad4"),o=o(),Ie(),o),Ut={class:"relative"},Pt={class:"w-full relative"},zt={class:"flex items-center gap-4"},Ht={class:"switch ml-02 my-01 flex-shrink-0"},Rt=Lt(()=>a("span",{class:"slider"},null,-1)),Qt={class:"text-left text-sm flex-grow"},Wt=q({__name:"InputToggle",props:{modelValue:{type:[Boolean,null]},label:{},innerClass:{},validation:{}},emits:["update:modelValue","update"],setup(o,{emit:c}){const t=o,g=c;let r=te(t,"modelValue",g);const k=v=>{v.code==="Space"&&(console.log("space toggle"),r.value=!r.value)},n=U({touched:!1}),h=S(()=>{if(n.touched)return!(f.value.length>0)}),w=()=>{n.touched=!0,g("update")},f=S(()=>{var s;let v=[];return n.touched&&(s=t.validation)!=null&&s.includes("required")&&t.modelValue===!1&&v.push("Bitte bestätige dieses Feld"),v}),m=he();return mt(m,"keyup",v=>{k(v)}),(v,s)=>{const i=X,_=ee;return u(),d("div",null,[a("div",{class:B(v.innerClass)},[a("div",Ut,[b(i,{label:t.label,class:"text-left"},null,8,["label"]),a("div",Pt,[a("div",zt,[a("label",Ht,[Q(a("input",{ref_key:"target",ref:m,type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=T=>K(r)?r.value=T:r=T),onInput:s[1]||(s[1]=T=>g("update")),onBlur:w,class:"fieldTarget"},null,544),[[Ve,e(r)]]),Rt]),a("div",Qt,[ve(v.$slots,"default",{},void 0,!0)])])])])],2),e(h)?F("",!0):(u(!0),d(M,{key:0},A(e(f),(T,O)=>(u(),d("div",{key:"error"+O},[b(_,{error:T},null,8,["error"])]))),128))])}}}),Gt=ge(Wt,[["__scopeId","data-v-0c5b6ad4"]]),Jt={class:"flex flex-col items-center justify-center text-center"},Zt=a("div",{class:"mb-4"},"Du hast folgenden Termin ausgewählt:",-1),Yt={class:"text-xl border rounded-full border-gold inline-block px-4 py-1 mb-10"},Kt=a("div",{class:"w-full lg:w-2/3 mb-10"}," Um Deine Buchung abzuschließen, benötige ich noch ein paar Informationen von Dir. Füll bitte untenstehendes Formular aus. ",-1),Xt=a("a",{href:"/datenschutz",target:"_blank",class:"underline"},"Datenschutzbestimmung",-1),en={class:"flex justify-center w-full"},tn={"aria-label":"Termin buchen",type:"submit",class:"border-2 border-gold bg-gold rounded text-offwhite flex items-center px-3 py-2 mb-20"},nn=a("div",{class:"text-coffee"},"Termin buchen",-1),on={class:"flex items-center justify-center bg-white rounded-full ml-2 w-4 h-4"},sn=q({__name:"BookingCalendarForm",props:{selectedTimeslot:{}},emits:["formSubmitted"],setup(o,{emit:c}){const{pb:t}=pe(),g=c,r=o,k=S(()=>r.selectedTimeslot?`${new Date(`${r.selectedTimeslot.year}-${r.selectedTimeslot.month}-${r.selectedTimeslot.day}`).toLocaleDateString("de-DE",{weekday:"short",year:"numeric",month:"numeric",day:"numeric"})} um ${r.selectedTimeslot.timeslot}`:void 0),n=U({form:{firstName:{value:void 0,validation:"required"},lastName:{value:void 0,validation:"required"},mail:{value:void 0,validation:"required|email"},phone:{value:void 0,validation:""},appointmentType:{value:void 0,validation:"required"},service:{value:void 0,validation:"required"},place:{value:void 0,validation:"required"},description:{value:void 0,validation:"required"},invoiceAddress:{value:void 0,validation:"required"},approvedCancellationConditions:{value:!1,validation:"required"},approvedDataprotection:{value:!1,validation:"required"}},success:!1,formSubmitted:!1,pending:!0}),h=()=>{{const s=document.querySelectorAll(".fieldTarget");for(const i of s)i.focus(),i.blur()}},w=S(()=>{let s=[];for(const i of Object.values(n.form))i.validation&&i.validation==="required"&&!i.value&&s.push("error");return s.length===0}),f=(s,i)=>{const _=i.split(":"),T=parseInt(_[0]),O=parseInt(_[1]);let V=new Date;V.setHours(T),V.setMinutes(O),V.setMinutes(V.getMinutes()+s);const l=V.getHours().toString().padStart(2,"0"),C=V.getMinutes().toString().padStart(2,"0");return l+":"+C},m=S(()=>{let s=[];for(const i of n.form.service.value)isNaN(parseInt(i))||s.push(i);return parseInt(s.join(""))}),v=async()=>{if(w.value){console.log("submitForm"),n.success=!1,n.formSubmitted=!1,n.pending=!0;try{const s={bookingType:"appointment",start:`${r.selectedTimeslot.year}-${r.selectedTimeslot.month}-${r.selectedTimeslot.day} ${r.selectedTimeslot.timeslot}:00.123Z`,end:`${r.selectedTimeslot.year}-${r.selectedTimeslot.month}-${r.selectedTimeslot.day} ${f(m.value,r.selectedTimeslot.timeslot)}:00.123Z`,firstName:n.form.firstName.value,lastName:n.form.lastName.value,mail:n.form.mail.value,phone:n.form.phone.value,appointmentType:n.form.appointmentType.value,service:n.form.service.value,place:n.form.place.value,description:n.form.description.value,invoiceAddress:n.form.invoiceAddress.value};console.log("data",s);const i=await t.collection("bookings").create(s);n.pending=!1,n.formSubmitted=!0,n.success=!0,g("formSubmitted",{success:!0,formValues:s})}catch(s){console.log("err",s),n.pending=!1,n.formSubmitted=!0,n.success=!1,g("formSubmitted",{success:!1,formValues:null})}}else h()};return fe(()=>{}),(s,i)=>{const _=nt,T=kt,O=Ct,V=qt,l=Gt,C=W;return u(),d("div",Jt,[Zt,a("div",Yt,N(e(k)),1),Kt,a("form",{onSubmit:Y(v,["prevent"]),class:"w-full lg:w-2/3 flex flex-wrap -m-2"},[b(_,{class:"mb-4"},{default:J(()=>[I("Deine Angaben")]),_:1}),b(T,{modelValue:e(n).form.firstName.value,"onUpdate:modelValue":i[0]||(i[0]=y=>e(n).form.firstName.value=y),label:"Vorname",placeholder:"Vorname",validation:e(n).form.firstName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(T,{modelValue:e(n).form.lastName.value,"onUpdate:modelValue":i[1]||(i[1]=y=>e(n).form.lastName.value=y),label:"Nachname",placeholder:"Nachname",validation:e(n).form.lastName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(T,{modelValue:e(n).form.mail.value,"onUpdate:modelValue":i[2]||(i[2]=y=>e(n).form.mail.value=y),label:"E-Mail",placeholder:"E-Mail",validation:e(n).form.mail.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(T,{modelValue:e(n).form.phone.value,"onUpdate:modelValue":i[3]||(i[3]=y=>e(n).form.phone.value=y),label:"Telefonnummer (optional)",placeholder:"Telefonnummer",validation:e(n).form.phone.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(O,{modelValue:e(n).form.appointmentType.value,"onUpdate:modelValue":i[4]||(i[4]=y=>e(n).form.appointmentType.value=y),options:e(oe).find(y=>y.type==="appointmentTypes").options,label:"Terminart",validation:e(n).form.appointmentType.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),b(O,{modelValue:e(n).form.service.value,"onUpdate:modelValue":i[5]||(i[5]=y=>e(n).form.service.value=y),options:e(oe).find(y=>y.type==="services").options,label:"Leistung",validation:e(n).form.service.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),b(O,{modelValue:e(n).form.place.value,"onUpdate:modelValue":i[6]||(i[6]=y=>e(n).form.place.value=y),options:[{label:"Online",value:"online"},{label:"Vor Ort in Harrislee",value:"inPerson"}],label:"Wo soll der Termin stattfinden?",validation:e(n).form.place.validation,class:"p-2 w-full lg:w-1/2 mb-8"},null,8,["modelValue","validation"]),b(_,{class:"mb-4"},{default:J(()=>[I("Terminvorbereitung")]),_:1}),b(V,{modelValue:e(n).form.description.value,"onUpdate:modelValue":i[7]||(i[7]=y=>e(n).form.description.value=y),label:"Beschreibung Deines Themas",placeholder:"Bitte beschreibe kurz Dein Thema",validation:e(n).form.description.validation,class:"p-2 w-full"},null,8,["modelValue","validation"]),b(V,{modelValue:e(n).form.invoiceAddress.value,"onUpdate:modelValue":i[8]||(i[8]=y=>e(n).form.invoiceAddress.value=y),label:"Rechnungsadresse",placeholder:"Bitte trage die gewünschte Rechnungsadresse ein",validation:e(n).form.invoiceAddress.validation,class:"p-2 w-full mb-6"},null,8,["modelValue","validation"]),b(_,{class:"mb-4"},{default:J(()=>[I("Rechtliches")]),_:1}),b(l,{modelValue:e(n).form.approvedCancellationConditions.value,"onUpdate:modelValue":i[9]||(i[9]=y=>e(n).form.approvedCancellationConditions.value=y),class:"p-2 w-full",innerClass:"",validation:e(n).form.approvedCancellationConditions.validation},{default:J(()=>[I(" Ich habe verstanden, dass eine kostenlose Stornierung meines Termins bis zu 48 Stunden vor Terminbeginn möglich ist und dass danach eine Ausfallgebühr von 50% fällig wird. ")]),_:1},8,["modelValue","validation"]),b(l,{modelValue:e(n).form.approvedDataprotection.value,"onUpdate:modelValue":i[10]||(i[10]=y=>e(n).form.approvedDataprotection.value=y),class:"p-2 w-full mb-6",innerClass:"",validation:e(n).form.approvedDataprotection.validation},{default:J(()=>[I(" Ich habe die "),Xt,I(" gelesen und bin damit einverstanden. ")]),_:1},8,["modelValue","validation"]),a("div",en,[a("button",tn,[nn,a("div",on,[b(C,{name:"icon-check",class:"text-sm text-coffee"})])])])],32)])}}}),ln={class:"max-container"},an={key:0,class:"flex justify-center my-20"},rn=a("div",{class:"w-full lg:w-2/3 border-2 rounded border-green bg-green bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[I(" Vielen Dank für Deine Buchung. "),a("br"),I(" Ich melde mich zeitnah per E-Mail bei Dir. ")],-1),un=[rn],dn={key:1,class:"flex justify-center my-20"},cn=a("div",{class:"w-full lg:w-2/3 border-2 rounded border-red bg-red bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[I(" Bei der Übermittlung Deiner Daten ist leider ein Fehler aufgetreten. "),a("br"),I("Versuch es bitte erneut. Sollte das Problem weiterhin bestehen, schreib mir bitte eine Mail an "),a("a",{href:"mailto:kontakt@eileengeorge.de",class:"underline"},"kontakt@eileengeorge.de"),I(". ")],-1),mn=[cn],pn={class:"flex items-center justify-center gap-10"},fn=["onClick"],bn=q({__name:"BookingCalendar",props:{component:{}},setup(o){const c=o,t=U({currentStep:0,steps:[{id:0,name:"Terminfindung"},{id:1,name:"Buchung"}],selectedTimeslot:void 0,formValues:void 0,formSubmitted:!1,success:void 0}),g=h=>{t.selectedTimeslot=h,t.currentStep=1},r=h=>{if(h===0)return t.selectedTimeslot!=null;if(h===1)return t.formValues!=null},k=h=>{h===0&&(t.currentStep=0),h===1&&r(0)&&(t.currentStep=1)},n=async h=>{try{if(console.log("payload",h),h.success===!1)console.log("state.success = false;",t.success=!1),t.success=!1;else{console.log("state.success = true;",t.success=!0);const w={...h.formValues,timeslot:t.selectedTimeslot};console.log("formData",w);const f=await fetch("/api/mail/sendMail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:"bookingRequestUser",recipient:h.formValues.mail,formData:w})}),m=await fetch("/api/mail/sendMail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:"bookingRequestOwner",recipient:"kontakt@eileengeorge.de",formData:w})}),v=await fetch("/api/mail/sendMail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:"bookingRequestOwner",recipient:"alexbueckner@gmail.com",formData:w})});t.success=!0}t.formSubmitted=!0}catch(w){console.error("Error sending Mail",w)}};return(h,w)=>{const f=W,m=Ze,v=sn;return u(),d("div",ln,[e(t).formSubmitted?(u(),d(M,{key:0},[e(t).success?(u(),d("div",an,un)):(u(),d("div",dn,mn))],64)):(u(),d(M,{key:1},[a("div",pn,[(u(!0),d(M,null,A(e(t).steps,(s,i)=>(u(),d("button",{"aria-label":"Schritt auswählen",onClick:_=>k(s.id),key:"step"+i,class:"flex flex-col gap-4 items-center justify-center w-1/3 py-10"},[a("div",{class:B([[e(t).currentStep===s.id?"bg-salmon/60":"bg-darkOffwhite"],"w-full h-[5px] rounded relative"])},[a("div",{class:B([[e(t).currentStep===s.id?"bg-salmon":"bg-darkOffwhite"],"w-5 h-5 rounded-full absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"])},[r(s.id)?(u(),Me(f,{key:0,name:"icon-check",class:"text-xl"})):F("",!0)],2)],2),a("div",{class:B([[e(t).currentStep===s.id?"text-coffee":"text-lightGrey"],""])},N(s.name),3)],8,fn))),128))]),Q(b(m,{onSelectTimeslot:g,component:c.component,selectedTimeslot:e(t).selectedTimeslot},null,8,["component","selectedTimeslot"]),[[ae,e(t).currentStep===0]]),Q(b(v,{onFormSubmitted:n,selectedTimeslot:e(t).selectedTimeslot},null,8,["selectedTimeslot"]),[[ae,e(t).currentStep===1]])],64))])}}});export{bn as default};
