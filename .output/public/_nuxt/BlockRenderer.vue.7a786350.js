import{_ as X}from"./nuxt-icon.vue.95d5fe45.js";import{a as I,b as P,u as d,o as u,f,h as r,i as S,l as _,L as H,M as Q,m as Y,k as Z,U as ee,s as M,r as te,p as O,q as oe,P as N,w as se,c as T,v as ne,X as ae,N as le,x as ce,F as re,V as ie}from"./entry.945ec815.js";import{_ as pe}from"./_plugin-vue_export-helper.c27b6911.js";const B=i=>(H("data-v-b9bca515"),i=i(),Q(),i),de={key:0,class:"element relative w-full h-0"},ue=B(()=>r("div",{class:"absolute top-1/2 border-b-2 border-gold w-full opacity-0"},null,-1)),me={class:"absolute top-1/2 transform -translate-y-1/2 w-full flex items-center justify-center opacity-0 z-10 gap-2"},ke={class:"flex items-center bg-lightBlue rounded-full m-0"},be=B(()=>r("span",{style:{"padding-top":"2px"},class:"text-xs pr-2"}," Block ",-1)),fe={class:"flex items-center bg-lightGreen rounded-full m-0"},_e=B(()=>r("span",{style:{"padding-top":"2px"},class:"text-xs pr-2"}," Component ",-1)),ye=I({__name:"Adder",props:{displayComponentOption:{type:Boolean,default:!1}},emits:["addBlock","addComponent"],setup(i,{emit:e}){const b=i,m=P();return(y,p)=>{const k=X;return d(m).token?(u(),f("div",de,[ue,r("div",me,[r("button",{"aria-label":"Add Block",onClick:p[0]||(p[0]=x=>e("addBlock")),class:"p-0"},[r("div",ke,[S(k,{name:"icon-plus",class:"text-xl"}),be])]),b.displayComponentOption?(u(),f("button",{key:0,"aria-label":"Add Component",onClick:p[1]||(p[1]=x=>e("addComponent")),class:"p-0"},[r("div",fe,[S(k,{name:"icon-plus",class:"text-xl"}),_e])])):_("",!0)])])):_("",!0)}}});const xe=pe(ye,[["__scopeId","data-v-b9bca515"]]),he=["onClick"],Ce={class:"relative -top-6 h-0"},Me=I({__name:"BlockRenderer",props:{block:null,depth:{default:0},isFirst:{type:Boolean,default:!1}},setup(i){const e=i,{pb:b}=Y(),m=P(),y=Z(),p=ee(),{viewports:k,componentId:x}=M(y),{windowWidth:V}=M(p),{setComponentName:A,setComponentCss:$,setComponentId:E,setComponentContentType:F,setComponentContent:j,setComponentIsMaxContainer:z,setComponentBackgroundToMaxContainer:J,setComponentChildren:K}=y,{capitalize:q}=p,h=te({matrix:[]}),R=n=>{try{const a=JSON.parse(JSON.stringify(n.flat())).map(s=>Object.keys(s)[0]),l=[...new Set(a)];let o=k.value.map(s=>[]);for(const[s,L]of o.entries())if(s===0)o[s]=n[s];else if(n[s]){const C=o[s-1].map(t=>Object.entries(t)[0]),U=C.map(t=>t[0]),ve=C.map(t=>t[1]),v=n[s].map(t=>Object.entries(t)[0]),W=v.map(t=>t[0]),Be=v.map(t=>t[1]);for(const t of v)if(U.includes(t[0])){let c={};c[t[0]]=t[1],o[s].push(c)}else{let c={};c[t[0]]=t[1],o[s].push(c)}for(const t of C)if(!W.includes(t[0])){let c={};c[t[0]]=t[1],o[s].push(c)}}else o[s]=o[s-1];return JSON.parse(JSON.stringify(o))}catch{return[[],[],[],[],[]]}},g=O(()=>k.value.filter(n=>V.value>=n.value).reduce((n,a)=>n.value>a.value?n:a).id),w=O(()=>{h.matrix=R(e.block.cssClasses);const n=h.matrix.map(l=>l.filter(o=>!(o.hasOwnProperty("background")&&!e.block.limitBackgroundToMaxContainer)))[g.value];return{container:h.matrix.map(l=>l.filter(o=>!!(o.hasOwnProperty("background")&&!e.block.limitBackgroundToMaxContainer||o.hasOwnProperty("width"))))[g.value],block:n}}),D=()=>{m.token&&(console.log("props.block.id",e.block.id),E(e.block.id),z(e.block.isMaxContainer),J(e.block.limitBackgroundToMaxContainer),$(e.block.cssClasses),A("SidebarBlock"),F(e.block.type),j(e.block.content),K(e.block.expand.blocks))},G=async n=>{console.log("container",n);const a=await b.collection("blocks").create({type:"default",isMaxContainer:!1,cssClasses:[[{paddingTop:"40px"},{paddingBottom:"40px"},{marginTop:"40px"},{marginBottom:"40px"}],[],[],[],[]]});let l=e.block.blocks;l.push(a.id),await b.collection("blocks").update(n.id,{blocks:l}),ie.emit("refresh")};return oe(()=>{}),(n,a)=>{var o,s;const l=xe;return u(),f(re,null,[(o=e.block)!=null&&o.type?(u(),f("div",{key:0,id:"sidebarTarget",style:N([d(w).container]),onClick:se(D,["stop"]),class:"flex"},[(u(),T(ae("Block"+d(q)(e.block.type)),{block:e.block,isFirst:e.isFirst,depth:e.depth+1,style:N([d(w).block]),class:ne([{"hover:shadow-block":d(m).token},{"shadow-block":d(m).token&&d(x)===((s=e.block)==null?void 0:s.id)},{"max-container":e.block.isMaxContainer}])},null,8,["block","isFirst","depth","style","class"]))],12,he)):_("",!0),r("div",Ce,[e.depth===0?(u(),T(l,{key:0,onAddBlock:a[0]||(a[0]=L=>G(e.block))},{default:le(()=>[ce("Block")]),_:1})):_("",!0)])],64)}}});export{Me as _,xe as a};
