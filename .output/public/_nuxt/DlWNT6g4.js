import{_ as W}from"./DYqNPgwz.js";import{f as q,u as fe,l as S,r as U,m as pe,o as u,c as m,a as r,n as e,C as Y,b,v as N,t as F,F as M,x as j,z as A,d as I,U as ve,R as we,O as xe,N as ne,I as he,Q as De,A as R,V as Te,W as K,X as ke,E as $e,Y as Ve,p as Se,e as Ie,w as J,q as Me,B as ae}from"./COIFjB77.js";import{d as oe}from"./F1WjrixK.js";import{_ as ge}from"./DlAUqK2U.js";import{u as Oe}from"./EqJpNlPG.js";const Ce={class:"flex flex-col lg:flex-row gap-10 mb-36"},Fe={class:"w-full lg:w-1/2"},Ne={class:"flex items-center justify-between mb-2"},Ee={style:{width:"14.285%"},class:"flex items-center justify-center"},Be={style:{width:"14.285%"},class:"flex items-center justify-center"},Ae={class:"weekdays flex justify-start mb-2"},je={class:"flex flex-wrap justify-start"},qe={class:"w-full aspect-square flex items-center justify-center"},Le=["onClick"],Ue={key:1,class:"w-full aspect-square flex items-center justify-center"},Pe={class:"w-full lg:w-1/2"},ze={key:0,class:"text-md mb-10 mt-6"},He=r("br",null,null,-1),Qe=r("br",null,null,-1),Re={class:""},We={class:"mb-3"},Ge={class:""},Je={class:"flex items-center flex-wrap gap-2"},Ze=["onClick"],Ye=q({__name:"BookingCalendarDate",props:{component:{default:{content:oe.find(n=>n.type==="bookingCalendar").content}},selectedTimeslot:{}},emits:["selectTimeslot"],setup(n,{emit:d}){const{pb:a}=fe(),i=d,c=n,T=["Mo","Di","Mi","Do","Fr","Sa","So"],t=(v,k)=>new Date(v,k+1,0).getDate(),$=(v,k)=>(new Date(v,k,1).getDay()+7-1)%7,_=(v,k,w)=>new Date(v,k,w).getDay(),f=()=>{C.value<s.maxMonth&&(s.month<11?s.month++:(s.month=0,s.year++))},p=()=>{C.value>s.minMonth&&(s.month>0?s.month--:(s.month=11,s.year--))},h=(v,k)=>{const w=new Date(v);return w.setDate(w.getDate()+k),w},l=(v,k)=>{const w=new Date(v);return w.setMonth(w.getMonth()+k),w},o=v=>v===6||v===0,g=(v,k,w)=>{const D=new Date().setHours(0,0,0,0),E=new Date(h(D,5)).setHours(0,0,0,0);return new Date(v,k,w).setHours(0,0,0,0)<E},x=S(()=>{const v=t(s.year,s.month);return Array.from(Array(v).keys()).map(w=>w+1).map(w=>{const D=_(s.year,s.month,w);return{date:w,weekday:D,isDisabled:o(D)||g(s.year,s.month,w)}})}),O=S(()=>$(s.year,s.month)),V=S(()=>{let v=s.month,k=s.year;v>0?v--:(v=11,k--);const w=Array.from(Array(t(k,v)).keys()).map(D=>D+1);if(O.value===0)return[];{const D=-1*O.value;return w.slice(D)}}),s=U({step:1,minMonth:Number(new Date().toISOString().split("-").slice(0,2).join("")),maxMonth:Number(l(new Date,3).toISOString().split("-").slice(0,2).join("")),today:new Date,month:new Date().getMonth(),year:new Date().getFullYear(),selectedDate:void 0,appointmentsOfTheDay:[],timeslots:[]}),C=S(()=>Number(new Date(s.year,s.month+1).toISOString().split("-").slice(0,2).join("")));S(()=>{const v=new Date(s.minMonth).getMonth(),k=new Date(s.maxMonth).getMonth()+3;return v<k});const y=async v=>{s.selectedDate=new Date(s.year,s.month,v).setHours(0,0,0,0),await se(),await le()},P=S(()=>String(s.month+1).padStart(2,"0")),z=S(()=>String(new Date(s.selectedDate).getDate()).padStart(2,"0")),se=async()=>{const v=`start <= "${s.year}-${P.value}-${z.value} 23:59:59" && end >= "${s.year}-${P.value}-${z.value} 00:00:00"`,k=await a.collection("bookings").getFullList(200,{filter:v});s.appointmentsOfTheDay=k},ye=(v,k)=>{let w=[];const D=new Date(`${s.year}-${P.value}-${z.value} `+v),E=new Date(`${s.year}-${P.value}-${z.value} `+k);let B=D;for(;B<=E;){console.log("currentTime.toLocaleTimeString()",B.toLocaleTimeString());const G=B.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(s.appointmentsOfTheDay.length>0){let H=[];for(const L of s.appointmentsOfTheDay){let Q=new Date(new Date(L.start).getTime()+new Date(L.start).getTimezoneOffset()*6e4);Q.setMinutes(Q.getMinutes()-80);const Z=new Date(new Date(L.end).getTime()+new Date(L.end).getTimezoneOffset()*6e4);Z.setMinutes(Z.getMinutes()+30),console.log("appointmentStart",Q.toLocaleTimeString()," || appointmentEnd",Z.toLocaleTimeString()),B>=Q&&B<Z?H.push(1):H.push(0)}H.reduce((L,Q)=>L+Q,0)===0&&w.push(G)}else w.push(G);B.setMinutes(B.getMinutes()+30)}return w},le=()=>{const v=c.component.content.days.find(k=>k.id===new Date(s.selectedDate).getDay());s.timeslots=ye(v==null?void 0:v.startTime,v==null?void 0:v.endTime)};return pe(async()=>{await se(),await le()}),(v,k)=>{const w=W;return u(),m("div",Ce,[r("div",Fe,[r("div",Ne,[r("div",Ee,[e(C)>e(s).minMonth?(u(),m("button",{key:0,"aria-label":"Monat zurück",onClick:Y(p,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[b(w,{name:"icon-caret-left",class:"text-xl"})])):N("",!0)]),r("div",null,F(new Date(e(s).year,e(s).month).toLocaleString("de-DE",{month:"long"})),1),r("div",Be,[e(C)<e(s).maxMonth?(u(),m("button",{key:0,"aria-label":"Monat vor",onClick:Y(f,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[b(w,{name:"icon-caret-right",class:"text-xl"})])):N("",!0)])]),r("div",Ae,[(u(),m(M,null,j(T,(D,E)=>r("div",{key:"weekday"+E,style:{width:"14.285%"},class:"flex items-center justify-center text-lightGrey text-opacity-60"},F(D),1)),64))]),r("div",je,[(u(!0),m(M,null,j(e(V),(D,E)=>(u(),m("div",{key:"offset"+E,style:{width:"14.285%"},class:"offsets text-lightGrey text-opacity-60 flex items-center justify-center flex-shrink-0"},[r("div",qe,F(D),1)]))),128)),(u(!0),m(M,null,j(e(x),(D,E)=>(u(),m("div",{key:"day"+E,style:{width:"14.285%"},class:A([[D.isDisabled?"text-lightGrey text-opacity-60":""],"flex items-center justify-center flex-shrink-0 p-1"])},[D.isDisabled?(u(),m("div",Ue,F(D.date),1)):(u(),m("button",{key:0,"aria-label":"Tag auswählen",onClick:Y(B=>y(D.date),["stop"]),class:A(["hover:border hover:border-gold rounded-full w-full aspect-square",[e(s).selectedDate===new Date(e(s).year,e(s).month,D.date).setHours(0,0,0,0)?"bg-gold":""]])},F(D.date),11,Le))],2))),128))])]),r("div",Pe,[e(s).selectedDate?(u(),m(M,{key:1},[e(s).timeslots.length===0?(u(),m(M,{key:0},[I(" Am "),r("span",Re,F(new Date(e(s).selectedDate).toLocaleDateString("de-DE",{})),1),I(" stehen Dir leider keine freien Termine zur Verfügung. ")],64)):(u(),m(M,{key:1},[r("div",We,[I(" Am "),r("span",Ge,F(new Date(e(s).selectedDate).toLocaleDateString("de-DE",{})),1),I(" stehen Dir folgende Termine zur Verfügung: ")]),r("div",Je,[(u(!0),m(M,null,j(e(s).timeslots,(D,E)=>{var B,G,H;return u(),m("button",{"aria-label":"Zeitslot auswählen",onClick:L=>i("selectTimeslot",{year:e(s).year,month:e(P),day:e(z),timeslot:D}),key:"timeslot"+E,class:A([[((B=c.selectedTimeslot)==null?void 0:B.month)===e(P)&&((G=c.selectedTimeslot)==null?void 0:G.day)===e(z)&&((H=c.selectedTimeslot)==null?void 0:H.timeslot)===D?"bg-gold":"hover:bg-gold"],"border border-gold rounded px-1 py-1 w-14 flex items-center justify-center"])},F(D),11,Ze)}),128))])],64))],64)):(u(),m("h2",ze,[I(" Hier kannst Du ganz bequem über das Online Buchungstool einen Erst- oder Folgetermin buchen."),He,Qe,I(" Wähle dafür ein Datum und eine passende Uhrzeit aus. ")]))])])}}}),Ke={},Xe={class:"w-full flex items-center px-4"},et={class:"mr-2"},tt=r("div",{class:"border-b border-sand flex-grow"},null,-1);function nt(n,d){return u(),m("div",Xe,[r("h2",et,[ve(n.$slots,"default")]),tt])}const ot=ge(Ke,[["render",nt]]),X=q({__name:"InputLabel",props:{label:{}},setup(n){const d=n;return(a,i)=>(u(),m("div",{class:A(["text-xs ml-2",[{"mb-1":d.label}]])},F(d.label),3))}}),st={class:"bg-red bg-opacity-40 text-red text-sm mt-1 px-1 py-[2px] rounded"},ee=q({__name:"InputError",props:{error:{}},setup(n){const d=n;return(a,i)=>(u(),m("div",st,F(d.error),1))}});var re;const _e=typeof window<"u",lt=n=>typeof n<"u",at=n=>typeof n=="function",rt=n=>typeof n=="string",it=()=>{};_e&&((re=window==null?void 0:window.navigator)!=null&&re.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function be(n){return typeof n=="function"?n():e(n)}function ut(n){return n}function dt(n){return we()?(xe(n),!0):!1}function ct(n){var d;const a=be(n);return(d=a==null?void 0:a.$el)!=null?d:a}const mt=_e?window:void 0;function ft(...n){let d,a,i,c;if(rt(n[0])||Array.isArray(n[0])?([a,i,c]=n,d=mt):[d,a,i,c]=n,!d)return it;Array.isArray(a)||(a=[a]),Array.isArray(i)||(i=[i]);const T=[],t=()=>{T.forEach(p=>p()),T.length=0},$=(p,h,l,o)=>(p.addEventListener(h,l,o),()=>p.removeEventListener(h,l,o)),_=ne(()=>[ct(d),be(c)],([p,h])=>{t(),p&&T.push(...a.flatMap(l=>i.map(o=>$(p,l,o,h))))},{immediate:!0,flush:"post"}),f=()=>{_(),t()};return dt(f),f}function pt(n){return JSON.parse(JSON.stringify(n))}const ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ue="__vueuse_ssr_handlers__";ie[ue]=ie[ue]||{};var de;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(de||(de={}));var vt=Object.defineProperty,ce=Object.getOwnPropertySymbols,ht=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,me=(n,d,a)=>d in n?vt(n,d,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[d]=a,_t=(n,d)=>{for(var a in d||(d={}))ht.call(d,a)&&me(n,a,d[a]);if(ce)for(var a of ce(d))gt.call(d,a)&&me(n,a,d[a]);return n};const bt={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};_t({linear:ut},bt);function te(n,d,a,i={}){var c,T,t;const{clone:$=!1,passive:_=!1,eventName:f,deep:p=!1,defaultValue:h}=i,l=De(),o=a||(l==null?void 0:l.emit)||((c=l==null?void 0:l.$emit)==null?void 0:c.bind(l))||((t=(T=l==null?void 0:l.proxy)==null?void 0:T.$emit)==null?void 0:t.bind(l==null?void 0:l.proxy));let g=f;g=f||g||`update:${d.toString()}`;const x=V=>$?at($)?$(V):pt(V):V,O=()=>lt(n[d])?x(n[d]):h;if(_){const V=O(),s=he(V);return ne(()=>n[d],C=>s.value=x(C)),ne(s,C=>{(C!==n[d]||p)&&o(g,C)},{deep:p}),s}else return S({get(){return O()},set(V){o(g,V)}})}const yt={class:"relative"},wt={class:"w-full relative"},xt=["type","placeholder"],Dt={class:"absolute top-1/2 right-2 transform -translate-y-1/2"},Tt={key:0,class:"bg-green bg-opacity-40 rounded"},kt={key:1,class:"bg-red bg-opacity-40 rounded"},$t=q({__name:"Input",props:{modelValue:{},label:{},innerClass:{},inputClass:{default:"pl-2 pr-10 py-1 w-full border border-grey rounded"},placeholder:{},validation:{},type:{default:"text"}},emits:["update:modelValue","update"],setup(n,{emit:d}){const a=n,i=U({touched:!1}),c=S(()=>{if(i.touched)return!(T.value.length>0)}),T=S(()=>{var p,h,l;let f=[];return i.touched&&((p=a.validation)!=null&&p.includes("required")&&(a.modelValue||f.push("Dieses Feld ist ein Pflichtfeld")),(h=a.validation)!=null&&h.includes("email")&&((l=a.modelValue)==null?void 0:l.includes("@"))===!1&&f.push("Bitte gib eine gültige E-Mail-Adresse ein")),f}),t=()=>{i.touched=!0,$("update")},$=d,_=te(a,"modelValue",$);return(f,p)=>{const h=X,l=W,o=ee;return u(),m("div",{class:A(f.innerClass)},[r("div",yt,[b(h,{label:a.label,class:"text-left"},null,8,["label"]),r("div",wt,[R(r("input",{autocomplete:"disabled",type:f.type,placeholder:f.placeholder,class:A([a.inputClass,"fieldTarget"]),"onUpdate:modelValue":p[0]||(p[0]=g=>K(_)?_.value=g:null),onBlur:t},null,42,xt),[[Te,e(_)]]),r("div",Dt,[e(c)?(u(),m("div",Tt,[b(l,{name:"icon-check",class:"text-green text-xl"})])):N("",!0),e(c)===!1?(u(),m("div",kt,[b(l,{name:"icon-cross",class:"text-red text-xl"})])):N("",!0)])]),e(c)?N("",!0):(u(!0),m(M,{key:0},j(e(T),(g,x)=>(u(),m("div",{key:"error"+x},[b(o,{error:g},null,8,["error"])]))),128))])],2)}}}),Vt={class:"relative"},St={class:"w-full relative"},It=["value","selected"],Mt={class:"absolute top-1/2 right-5 transform -translate-y-1/2"},Ot={key:0,class:"bg-green bg-opacity-40 rounded"},Ct={key:1,class:"bg-red bg-opacity-40 rounded"},Ft=q({__name:"InputSelect",props:{modelValue:{},label:{},options:{},innerClass:{},validation:{}},emits:["update:modelValue","update"],setup(n,{emit:d}){const a=n,i=d,c=te(a,"modelValue",i),T=U({touched:!1}),t=S(()=>{if(T.touched)return!($.value.length>0)}),$=S(()=>{var p;let f=[];return T.touched&&(p=a.validation)!=null&&p.includes("required")&&(a.modelValue||f.push("Wähle bitte eine Option")),f}),_=()=>{T.touched=!0,i("update")};return(f,p)=>{const h=X,l=W,o=ee;return u(),m("div",{class:A(f.innerClass)},[r("div",Vt,[b(h,{label:a.label,class:"text-left"},null,8,["label"]),r("div",St,[R(r("select",{onBlur:_,"onUpdate:modelValue":p[0]||(p[0]=g=>K(c)?c.value=g:null),onInput:p[1]||(p[1]=g=>i("update")),class:"fieldTarget w-full border border-grey rounded pl-2 pr-8 py-[6px]"},[(u(!0),m(M,null,j(a.options,(g,x)=>(u(),m("option",{key:"option"+x,value:g.value,selected:g.value===e(c)},F(g.label),9,It))),128))],544),[[ke,e(c)]]),r("div",Mt,[e(t)?(u(),m("div",Ot,[b(l,{name:"icon-check",class:"text-green text-xl"})])):N("",!0),e(t)===!1?(u(),m("div",Ct,[b(l,{name:"icon-cross",class:"text-red text-xl"})])):N("",!0)])]),e(t)?N("",!0):(u(!0),m(M,{key:0},j(e($),(g,x)=>(u(),m("div",{key:"error"+x},[b(o,{error:g},null,8,["error"])]))),128))])],2)}}}),Nt={class:"relative"},Et={class:"w-full relative"},Bt=["type","placeholder"],At={class:"absolute top-2 right-2"},jt={key:0,class:"bg-green bg-opacity-40 rounded"},qt={key:1,class:"bg-red bg-opacity-40 rounded"},Lt=q({__name:"InputTextarea",props:{modelValue:{},label:{},innerClass:{},placeholder:{},validation:{},type:{default:"textarea"}},emits:["update:modelValue","update"],setup(n,{emit:d}){const a=n,i=U({touched:!1}),c=S(()=>{if(i.touched)return!(T.value.length>0)}),T=S(()=>{var p,h,l;let f=[];return i.touched&&((p=a.validation)!=null&&p.includes("required")&&(a.modelValue||f.push("Dieses Feld ist ein Pflichtfeld")),(h=a.validation)!=null&&h.includes("email")&&((l=a.modelValue)==null?void 0:l.includes("@"))===!1&&f.push("Bitte gib eine gültige E-Mail-Adresse ein")),f}),t=()=>{i.touched=!0,$("update")},$=d,_=te(a,"modelValue",$);return(f,p)=>{const h=X,l=W,o=ee;return u(),m("div",{class:A(f.innerClass)},[r("div",Nt,[b(h,{label:a.label,class:"text-left"},null,8,["label"]),r("div",Et,[R(r("textarea",{autocomplete:"disabled",type:f.type,placeholder:f.placeholder,"onUpdate:modelValue":p[0]||(p[0]=g=>K(_)?_.value=g:null),onBlur:t,class:"fieldTarget w-full p-2 border border-grey rounded"},null,40,Bt),[[$e,e(_)]]),r("div",At,[e(c)?(u(),m("div",jt,[b(l,{name:"icon-check",class:"text-green text-xl"})])):N("",!0),e(c)===!1?(u(),m("div",qt,[b(l,{name:"icon-cross",class:"text-red text-xl"})])):N("",!0)])]),e(c)?N("",!0):(u(!0),m(M,{key:0},j(e(T),(g,x)=>(u(),m("div",{key:"error"+x},[b(o,{error:g},null,8,["error"])]))),128))])],2)}}}),Ut=n=>(Se("data-v-0c5b6ad4"),n=n(),Ie(),n),Pt={class:"relative"},zt={class:"w-full relative"},Ht={class:"flex items-center gap-4"},Qt={class:"switch ml-02 my-01 flex-shrink-0"},Rt=Ut(()=>r("span",{class:"slider"},null,-1)),Wt={class:"text-left text-sm flex-grow"},Gt=q({__name:"InputToggle",props:{modelValue:{type:[Boolean,null]},label:{},innerClass:{},validation:{}},emits:["update:modelValue","update"],setup(n,{emit:d}){const a=n,i=d;let c=te(a,"modelValue",i);const T=h=>{h.code==="Space"&&(console.log("space toggle"),c.value=!c.value)},t=U({touched:!1}),$=S(()=>{if(t.touched)return!(f.value.length>0)}),_=()=>{t.touched=!0,i("update")},f=S(()=>{var l;let h=[];return t.touched&&(l=a.validation)!=null&&l.includes("required")&&a.modelValue===!1&&h.push("Bitte bestätige dieses Feld"),h}),p=he();return ft(p,"keyup",h=>{T(h)}),(h,l)=>{const o=X,g=ee;return u(),m("div",null,[r("div",{class:A(h.innerClass)},[r("div",Pt,[b(o,{label:a.label,class:"text-left"},null,8,["label"]),r("div",zt,[r("div",Ht,[r("label",Qt,[R(r("input",{ref_key:"target",ref:p,type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=x=>K(c)?c.value=x:c=x),onInput:l[1]||(l[1]=x=>i("update")),onBlur:_,class:"fieldTarget"},null,544),[[Ve,e(c)]]),Rt]),r("div",Wt,[ve(h.$slots,"default",{},void 0,!0)])])])])],2),e($)?N("",!0):(u(!0),m(M,{key:0},j(e(f),(x,O)=>(u(),m("div",{key:"error"+O},[b(g,{error:x},null,8,["error"])]))),128))])}}}),Jt=ge(Gt,[["__scopeId","data-v-0c5b6ad4"]]),Zt={class:"flex flex-col items-center justify-center text-center"},Yt=r("div",{class:"mb-4"},"Du hast folgenden Termin ausgewählt:",-1),Kt={class:"text-xl border rounded-full border-gold inline-block px-4 py-1 mb-10"},Xt=r("div",{class:"w-full lg:w-2/3 mb-10"}," Um Deine Buchung abzuschließen, benötige ich noch ein paar Informationen von Dir. Füll bitte untenstehendes Formular aus. ",-1),en=r("a",{href:"/datenschutz",target:"_blank",class:"underline"},"Datenschutzbestimmung",-1),tn={class:"flex justify-center w-full"},nn={"aria-label":"Termin buchen",type:"submit",class:"border-2 border-gold bg-gold rounded text-offwhite flex items-center px-3 py-2 mb-20"},on=r("div",{class:"text-coffee"},"Termin buchen",-1),sn={class:"flex items-center justify-center bg-white rounded-full ml-2 w-4 h-4"},ln=q({__name:"BookingCalendarForm",props:{selectedTimeslot:{}},emits:["formSubmitted"],setup(n,{emit:d}){const{pb:a}=fe(),i=d,c=n,T=S(()=>c.selectedTimeslot?`${new Date(`${c.selectedTimeslot.year}-${c.selectedTimeslot.month}-${c.selectedTimeslot.day}`).toLocaleDateString("de-DE",{weekday:"short",year:"numeric",month:"numeric",day:"numeric"})} um ${c.selectedTimeslot.timeslot}`:void 0),t=U({form:{firstName:{value:void 0,validation:"required"},lastName:{value:void 0,validation:"required"},mail:{value:void 0,validation:"required|email"},phone:{value:void 0,validation:""},appointmentType:{value:void 0,validation:"required"},service:{value:void 0,validation:"required"},place:{value:void 0,validation:"required"},description:{value:void 0,validation:"required"},invoiceAddress:{value:void 0,validation:"required"},approvedCancellationConditions:{value:!1,validation:"required"},approvedDataprotection:{value:!1,validation:"required"}},success:!1,formSubmitted:!1,pending:!0}),$=()=>{{const l=document.querySelectorAll(".fieldTarget");for(const o of l)o.focus(),o.blur()}},_=S(()=>{let l=[];for(const o of Object.values(t.form))o.validation&&o.validation==="required"&&!o.value&&l.push("error");return l.length===0}),f=(l,o)=>{const g=o.split(":"),x=parseInt(g[0]),O=parseInt(g[1]);let V=new Date;V.setHours(x),V.setMinutes(O),V.setMinutes(V.getMinutes()+l);const s=V.getHours().toString().padStart(2,"0"),C=V.getMinutes().toString().padStart(2,"0");return s+":"+C},p=S(()=>{let l=[];for(const o of t.form.service.value)isNaN(parseInt(o))||l.push(o);return parseInt(l.join(""))}),h=async()=>{if(_.value){console.log("submitForm"),t.success=!1,t.formSubmitted=!1,t.pending=!0;try{const l={bookingType:"appointment",start:`${c.selectedTimeslot.year}-${c.selectedTimeslot.month}-${c.selectedTimeslot.day} ${c.selectedTimeslot.timeslot}:00.123Z`,end:`${c.selectedTimeslot.year}-${c.selectedTimeslot.month}-${c.selectedTimeslot.day} ${f(p.value,c.selectedTimeslot.timeslot)}:00.123Z`,firstName:t.form.firstName.value,lastName:t.form.lastName.value,mail:t.form.mail.value,phone:t.form.phone.value,appointmentType:t.form.appointmentType.value,service:t.form.service.value,place:t.form.place.value,description:t.form.description.value,invoiceAddress:t.form.invoiceAddress.value};console.log("data",l);const o=await a.collection("bookings").create(l);t.pending=!1,t.formSubmitted=!0,t.success=!0,i("formSubmitted",{success:!0,formValues:l})}catch(l){console.log("err",l),t.pending=!1,t.formSubmitted=!0,t.success=!1,i("formSubmitted",{success:!1,formValues:null})}}else $()};return pe(()=>{}),(l,o)=>{const g=ot,x=$t,O=Ft,V=Lt,s=Jt,C=W;return u(),m("div",Zt,[Yt,r("div",Kt,F(e(T)),1),Xt,r("form",{onSubmit:Y(h,["prevent"]),class:"w-full lg:w-2/3 flex flex-wrap -m-2"},[b(g,{class:"mb-4"},{default:J(()=>[I("Deine Angaben")]),_:1}),b(x,{modelValue:e(t).form.firstName.value,"onUpdate:modelValue":o[0]||(o[0]=y=>e(t).form.firstName.value=y),label:"Vorname",placeholder:"Vorname",validation:e(t).form.firstName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(x,{modelValue:e(t).form.lastName.value,"onUpdate:modelValue":o[1]||(o[1]=y=>e(t).form.lastName.value=y),label:"Nachname",placeholder:"Nachname",validation:e(t).form.lastName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(x,{modelValue:e(t).form.mail.value,"onUpdate:modelValue":o[2]||(o[2]=y=>e(t).form.mail.value=y),label:"E-Mail",placeholder:"E-Mail",validation:e(t).form.mail.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(x,{modelValue:e(t).form.phone.value,"onUpdate:modelValue":o[3]||(o[3]=y=>e(t).form.phone.value=y),label:"Telefonnummer (optional)",placeholder:"Telefonnummer",validation:e(t).form.phone.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),b(O,{modelValue:e(t).form.appointmentType.value,"onUpdate:modelValue":o[4]||(o[4]=y=>e(t).form.appointmentType.value=y),options:e(oe).find(y=>y.type==="appointmentTypes").options,label:"Terminart",validation:e(t).form.appointmentType.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),b(O,{modelValue:e(t).form.service.value,"onUpdate:modelValue":o[5]||(o[5]=y=>e(t).form.service.value=y),options:e(oe).find(y=>y.type==="services").options,label:"Leistung",validation:e(t).form.service.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),b(O,{modelValue:e(t).form.place.value,"onUpdate:modelValue":o[6]||(o[6]=y=>e(t).form.place.value=y),options:[{label:"Online",value:"online"},{label:"Vor Ort in Harrislee",value:"inPerson"}],label:"Wo soll der Termin stattfinden?",validation:e(t).form.place.validation,class:"p-2 w-full lg:w-1/2 mb-8"},null,8,["modelValue","validation"]),b(g,{class:"mb-4"},{default:J(()=>[I("Terminvorbereitung")]),_:1}),b(V,{modelValue:e(t).form.description.value,"onUpdate:modelValue":o[7]||(o[7]=y=>e(t).form.description.value=y),label:"Beschreibung Deines Themas",placeholder:"Bitte beschreibe kurz Dein Thema",validation:e(t).form.description.validation,class:"p-2 w-full"},null,8,["modelValue","validation"]),b(V,{modelValue:e(t).form.invoiceAddress.value,"onUpdate:modelValue":o[8]||(o[8]=y=>e(t).form.invoiceAddress.value=y),label:"Rechnungsadresse",placeholder:"Bitte trage die gewünschte Rechnungsadresse ein",validation:e(t).form.invoiceAddress.validation,class:"p-2 w-full mb-6"},null,8,["modelValue","validation"]),b(g,{class:"mb-4"},{default:J(()=>[I("Rechtliches")]),_:1}),b(s,{modelValue:e(t).form.approvedCancellationConditions.value,"onUpdate:modelValue":o[9]||(o[9]=y=>e(t).form.approvedCancellationConditions.value=y),class:"p-2 w-full",innerClass:"",validation:e(t).form.approvedCancellationConditions.validation},{default:J(()=>[I(" Ich habe verstanden, dass eine kostenlose Stornierung meines Termins bis zu 48 Stunden vor Terminbeginn möglich ist und dass danach eine Ausfallgebühr von 50% fällig wird. ")]),_:1},8,["modelValue","validation"]),b(s,{modelValue:e(t).form.approvedDataprotection.value,"onUpdate:modelValue":o[10]||(o[10]=y=>e(t).form.approvedDataprotection.value=y),class:"p-2 w-full mb-6",innerClass:"",validation:e(t).form.approvedDataprotection.validation},{default:J(()=>[I(" Ich habe die "),en,I(" gelesen und bin damit einverstanden. ")]),_:1},8,["modelValue","validation"]),r("div",tn,[r("button",nn,[on,r("div",sn,[b(C,{name:"icon-check",class:"text-sm text-coffee"})])])])],32)])}}}),an={class:"max-container"},rn={key:0,class:"flex justify-center my-20"},un=r("div",{class:"w-full lg:w-2/3 border-2 rounded border-green bg-green bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[I(" Vielen Dank für Deine Buchung. "),r("br"),I(" Ich melde mich zeitnah per E-Mail bei Dir. ")],-1),dn=[un],cn={key:1,class:"flex justify-center my-20"},mn=r("div",{class:"w-full lg:w-2/3 border-2 rounded border-red bg-red bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[I(" Bei der Übermittlung Deiner Daten ist leider ein Fehler aufgetreten. "),r("br"),I("Versuch es bitte erneut. Sollte das Problem weiterhin bestehen, schreib mir bitte eine Mail an "),r("a",{href:"mailto:kontakt@eileengeorge.de",class:"underline"},"kontakt@eileengeorge.de"),I(". ")],-1),fn=[mn],pn={class:"flex items-center justify-center gap-10"},vn=["onClick"],wn=q({__name:"BookingCalendar",props:{component:{}},setup(n){const{sendMail:d}=Oe(),a=n,i=U({currentStep:0,steps:[{id:0,name:"Terminfindung"},{id:1,name:"Buchung"}],selectedTimeslot:void 0,formValues:void 0,formSubmitted:!1,success:void 0}),c=_=>{i.selectedTimeslot=_,i.currentStep=1},T=_=>{if(_===0)return i.selectedTimeslot!=null;if(_===1)return i.formValues!=null},t=_=>{_===0&&(i.currentStep=0),_===1&&T(0)&&(i.currentStep=1)},$=async _=>{try{if(console.log("payload",_),_.success===!1)console.log("state.success = false;",i.success=!1),i.success=!1;else{console.log("state.success = true;",i.success=!0);const f={..._.formValues,timeslot:i.selectedTimeslot};console.log("formData",f),await d("bookingRequestUser",_.formValues.mail,f),await d("bookingRequestOwner","kontakt@eileengeorge.de",f),await d("bookingRequestOwner","alexbueckner@gmail.com",f),i.success=!0}i.formSubmitted=!0}catch(f){console.error("Error sending Mail",f)}};return(_,f)=>{const p=W,h=Ye,l=ln;return u(),m("div",an,[e(i).formSubmitted?(u(),m(M,{key:0},[e(i).success?(u(),m("div",rn,dn)):(u(),m("div",cn,fn))],64)):(u(),m(M,{key:1},[r("div",pn,[(u(!0),m(M,null,j(e(i).steps,(o,g)=>(u(),m("button",{"aria-label":"Schritt auswählen",onClick:x=>t(o.id),key:"step"+g,class:"flex flex-col gap-4 items-center justify-center w-1/3 py-10"},[r("div",{class:A([[e(i).currentStep===o.id?"bg-salmon/60":"bg-darkOffwhite"],"w-full h-[5px] rounded relative"])},[r("div",{class:A([[e(i).currentStep===o.id?"bg-salmon":"bg-darkOffwhite"],"w-5 h-5 rounded-full absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"])},[T(o.id)?(u(),Me(p,{key:0,name:"icon-check",class:"text-xl"})):N("",!0)],2)],2),r("div",{class:A([[e(i).currentStep===o.id?"text-coffee":"text-lightGrey"],""])},F(o.name),3)],8,vn))),128))]),R(b(h,{onSelectTimeslot:c,component:a.component,selectedTimeslot:e(i).selectedTimeslot},null,8,["component","selectedTimeslot"]),[[ae,e(i).currentStep===0]]),R(b(l,{onFormSubmitted:$,selectedTimeslot:e(i).selectedTimeslot},null,8,["selectedTimeslot"]),[[ae,e(i).currentStep===1]])],64))])}}});export{wn as default};
