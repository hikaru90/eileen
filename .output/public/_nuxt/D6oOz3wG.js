import{_ as U}from"./DIt6DktN.js";import{f as P,g as V,n as d,o as m,c as y,a as c,b as M,v as x,p as X,e as Y,u as Z,h as ee,i as te,s as N,r as oe,l as T,m as se,S as I,C as ne,q as A,z as ae,D as le,w as re,d as ce,F as ie,y as pe}from"./cWgfitSV.js";import{_ as de}from"./DlAUqK2U.js";const w=i=>(X("data-v-b9bca515"),i=i(),Y(),i),ue={key:0,class:"element relative w-full h-0"},me=w(()=>c("div",{class:"absolute top-1/2 border-b-2 border-gold w-full opacity-0"},null,-1)),ke={class:"absolute top-1/2 transform -translate-y-1/2 w-full flex items-center justify-center opacity-0 z-10 gap-2"},be={class:"flex items-center bg-lightBlue rounded-full m-0"},fe=w(()=>c("span",{style:{"padding-top":"2px"},class:"text-xs pr-2"}," Block ",-1)),ye={class:"flex items-center bg-lightGreen rounded-full m-0"},xe=w(()=>c("span",{style:{"padding-top":"2px"},class:"text-xs pr-2"}," Component ",-1)),_e=P({__name:"Adder",props:{displayComponentOption:{type:Boolean,default:!1}},emits:["addBlock","addComponent"],setup(i,{emit:_}){const k=V(),u=_,b=i;return(h,p)=>{const f=U;return d(k).token?(m(),y("div",ue,[me,c("div",ke,[c("button",{"aria-label":"Add Block",onClick:p[0]||(p[0]=C=>u("addBlock")),class:"p-0"},[c("div",be,[M(f,{name:"icon-plus",class:"text-xl"}),fe])]),b.displayComponentOption?(m(),y("button",{key:0,"aria-label":"Add Component",onClick:p[1]||(p[1]=C=>u("addComponent")),class:"p-0"},[c("div",ye,[M(f,{name:"icon-plus",class:"text-xl"}),xe])])):x("",!0)])])):x("",!0)}}}),he=de(_e,[["__scopeId","data-v-b9bca515"]]),Ce={class:"relative -top-6 h-0"},Oe=P({__name:"BlockRenderer",props:{block:{},depth:{default:0},isFirst:{type:Boolean,default:!1}},setup(i){const{$event:_}=pe(),{pb:k}=Z(),u=V(),b=ee(),h=te(),{viewports:p,componentId:f}=N(b),{windowWidth:C}=N(h),{setComponentName:$,setComponentCss:F,setComponentId:z,setComponentContentType:E,setComponentContent:j,setComponentIsMaxContainer:J,setComponentBackgroundToMaxContainer:K,setComponentChildren:q}=b,{capitalize:D}=h,e=i,v=oe({matrix:[]}),R=n=>{try{const a=JSON.parse(JSON.stringify(n.flat())).map(s=>Object.keys(s)[0]),l=[...new Set(a)];let o=p.value.map(s=>[]);for(const[s,H]of o.entries())if(s===0)o[s]=n[s];else if(n[s]){const B=o[s-1].map(t=>Object.entries(t)[0]),L=B.map(t=>t[0]),ve=B.map(t=>t[1]),g=n[s].map(t=>Object.entries(t)[0]),Q=g.map(t=>t[0]),Be=g.map(t=>t[1]);for(const t of g)if(L.includes(t[0])){let r={};r[t[0]]=t[1],o[s].push(r)}else{let r={};r[t[0]]=t[1],o[s].push(r)}for(const t of B)if(!Q.includes(t[0])){let r={};r[t[0]]=t[1],o[s].push(r)}}else o[s]=o[s-1];return JSON.parse(JSON.stringify(o))}catch{return[[],[],[],[],[]]}},S=T(()=>p.value.filter(n=>C.value>=n.value).reduce((n,a)=>n.value>a.value?n:a).id),O=T(()=>{v.matrix=R(e.block.cssClasses);const n=v.matrix.map(l=>l.filter(o=>!(o.hasOwnProperty("background")&&!e.block.limitBackgroundToMaxContainer)))[S.value];return{container:v.matrix.map(l=>l.filter(o=>!!(o.hasOwnProperty("background")&&!e.block.limitBackgroundToMaxContainer||o.hasOwnProperty("width"))))[S.value],block:n}}),G=()=>{u.token&&(console.log("props.block.id",e.block.id),z(e.block.id),J(e.block.isMaxContainer),K(e.block.limitBackgroundToMaxContainer),F(e.block.cssClasses),$("SidebarBlock"),E(e.block.type),j(e.block.content),q(e.block.expand.blocks))},W=async n=>{console.log("container",n);const a=await k.collection("blocks").create({type:"default",isMaxContainer:!1,cssClasses:[[{paddingTop:"40px"},{paddingBottom:"40px"},{marginTop:"40px"},{marginBottom:"40px"}],[],[],[],[]]});let l=e.block.blocks;l.push(a.id),await k.collection("blocks").update(n.id,{blocks:l}),_("refresh")};return se(()=>{}),(n,a)=>{var o,s;const l=he;return m(),y(ie,null,[(o=e.block)!=null&&o.type?(m(),y("div",{key:0,id:"sidebarTarget",style:I([d(O).container]),onClick:ne(G,["stop"]),class:"flex"},[(m(),A(le("Block"+d(D)(e.block.type)),{block:e.block,isFirst:e.isFirst,depth:e.depth+1,style:I([d(O).block]),class:ae([{"hover:shadow-block":d(u).token},{"shadow-block":d(u).token&&d(f)===((s=e.block)==null?void 0:s.id)},{"max-container":e.block.isMaxContainer}])},null,8,["block","isFirst","depth","style","class"]))],4)):x("",!0),c("div",Ce,[e.depth===0?(m(),A(l,{key:0,onAddBlock:a[0]||(a[0]=H=>W(e.block))},{default:re(()=>[ce("Block")]),_:1})):x("",!0)])],64)}}});export{he as _,Oe as a};
