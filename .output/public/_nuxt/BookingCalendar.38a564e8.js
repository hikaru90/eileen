import{_ as G}from"./nuxt-icon.vue.67b49880.js";import{a as j,m as me,e as ye,B as $,r as L,p as fe,o as d,f as c,h as r,u as e,w as Z,i as _,l as O,t as C,F as V,j as A,x as B,C as S,D as pe,E as we,G as xe,H as te,I as Te,J as ve,q as R,K as ke,L as K,M as De,v as $e,N as Se,z as Ve,A as Ie,O as W,c as Me,y as se}from"./entry.f2f8d813.js";import{d as ne}from"./defaults.fa42bbd5.js";import{_ as he}from"./_plugin-vue_export-helper.c27b6911.js";import{u as Ce}from"./useBrevo.119db180.js";const Oe={class:"flex flex-col lg:flex-row gap-10 mb-36"},Fe={class:"w-full lg:w-1/2"},Ne={class:"flex items-center justify-between mb-2"},Ee={style:{width:"14.285%"},class:"flex items-center justify-center"},Be=["onClick"],Ae={style:{width:"14.285%"},class:"flex items-center justify-center"},je=["onClick"],qe={class:"weekdays flex justify-start mb-2"},Le={class:"flex flex-wrap justify-start"},Ue={class:"w-full aspect-square flex items-center justify-center"},Pe=["onClick"],ze={key:1,class:"w-full aspect-square flex items-center justify-center"},He={class:"w-full lg:w-1/2"},Re={key:0,class:"font-bold text-md mb-10 mt-6"},Ge=r("br",null,null,-1),Qe=r("br",null,null,-1),We={class:"font-bold"},Je={class:"mb-3"},Ze={class:"font-bold"},Ke={class:"flex items-center flex-wrap gap-2"},Ye=["onClick"],Xe=j({__name:"BookingCalendarDate",props:{component:{default:{content:ne.find(n=>n.type==="bookingCalendar").content}},selectedTimeslot:null},emits:["selectTimeslot"],setup(n,{emit:i}){const o=n,{pb:a}=me();ye();const x=["Mo","Di","Mi","Do","Fr","Sa","So"],t=(h,T)=>new Date(h,T+1,0).getDate(),D=(h,T)=>{const y=new Date(h,T,1).getDay(),w=1;return(y+7-w)%7},k=(h,T,y)=>new Date(h,T,y).getDay(),p=()=>{F.value<l.maxMonth&&(l.month<11?l.month++:(l.month=0,l.year++))},f=()=>{F.value>l.minMonth&&(l.month>0?l.month--:(l.month=11,l.year--))},v=(h,T)=>{const y=new Date(h);return y.setDate(y.getDate()+T),y},u=(h,T)=>{const y=new Date(h);return y.setMonth(y.getMonth()+T),y},s=h=>h===6||h===0,m=(h,T,y)=>{const w=new Date().setHours(0,0,0,0),N=new Date(v(w,5)).setHours(0,0,0,0);return new Date(h,T,y).setHours(0,0,0,0)<N},b=$(()=>{const h=t(l.year,l.month);return Array.from(Array(h).keys()).map(y=>y+1).map(y=>{const w=k(l.year,l.month,y);return{date:y,weekday:w,isDisabled:s(w)||m(l.year,l.month,y)}})}),I=$(()=>D(l.year,l.month)),M=$(()=>{let h=l.month,T=l.year;h>0?h--:(h=11,T--);const y=Array.from(Array(t(T,h)).keys()).map(w=>w+1);if(I.value===0)return[];{const w=-1*I.value;return y.slice(w)}}),l=L({step:1,minMonth:Number(new Date().toISOString().split("-").slice(0,2).join("")),maxMonth:Number(u(new Date,3).toISOString().split("-").slice(0,2).join("")),today:new Date,month:new Date().getMonth(),year:new Date().getFullYear(),selectedDate:void 0,appointmentsOfTheDay:[],timeslots:[]}),F=$(()=>Number(new Date(l.year,l.month+1).toISOString().split("-").slice(0,2).join("")));$(()=>{const h=new Date(l.minMonth).getMonth(),T=new Date(l.maxMonth).getMonth()+3;return h<T});const g=async h=>{l.selectedDate=new Date(l.year,l.month,h).setHours(0,0,0,0),await oe(),await le()},U=$(()=>String(l.month+1).padStart(2,"0")),P=$(()=>String(new Date(l.selectedDate).getDate()).padStart(2,"0")),oe=async()=>{const h=`start <= "${l.year}-${U.value}-${P.value} 23:59:59" && end >= "${l.year}-${U.value}-${P.value} 00:00:00"`,T=await a.collection("bookings").getFullList(200,{filter:h});l.appointmentsOfTheDay=T},be=(h,T)=>{let y=[];const w=new Date(`${l.year}-${U.value}-${P.value} `+h),N=new Date(`${l.year}-${U.value}-${P.value} `+T);let E=w;for(;E<=N;){console.log("currentTime.toLocaleTimeString()",E.toLocaleTimeString());const Q=E.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(l.appointmentsOfTheDay.length>0){let z=[];for(const q of l.appointmentsOfTheDay){let H=new Date(new Date(q.start).getTime()+new Date(q.start).getTimezoneOffset()*6e4);H.setMinutes(H.getMinutes()-80);const J=new Date(new Date(q.end).getTime()+new Date(q.end).getTimezoneOffset()*6e4);J.setMinutes(J.getMinutes()+30),console.log("appointmentStart",H.toLocaleTimeString()," || appointmentEnd",J.toLocaleTimeString()),E>=H&&E<J?z.push(1):z.push(0)}z.reduce((q,H)=>q+H,0)===0&&y.push(Q)}else y.push(Q);E.setMinutes(E.getMinutes()+30)}return y},le=()=>{const h=o.component.content.days.find(T=>T.id===new Date(l.selectedDate).getDay());l.timeslots=be(h==null?void 0:h.startTime,h==null?void 0:h.endTime)};return fe(async()=>{await oe(),await le()}),(h,T)=>{const y=G;return d(),c("div",Oe,[r("div",Fe,[r("div",Ne,[r("div",Ee,[e(F)>e(l).minMonth?(d(),c("button",{key:0,"aria-label":"Monat zurück",onClick:Z(f,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[_(y,{name:"icon-caret-left",class:"text-xl"})],8,Be)):O("",!0)]),r("div",null,C(new Date(e(l).year,e(l).month).toLocaleString("de-DE",{month:"long"})),1),r("div",Ae,[e(F)<e(l).maxMonth?(d(),c("button",{key:0,"aria-label":"Monat vor",onClick:Z(p,["stop"]),class:"aspect-square w-full hover:bg-gold rounded-full m-3 flex items-center justify-center"},[_(y,{name:"icon-caret-right",class:"text-xl"})],8,je)):O("",!0)])]),r("div",qe,[(d(),c(V,null,A(x,(w,N)=>r("div",{key:"weekday"+N,style:{width:"14.285%"},class:"flex items-center justify-center text-lightGrey text-opacity-60"},C(w),1)),64))]),r("div",Le,[(d(!0),c(V,null,A(e(M),(w,N)=>(d(),c("div",{key:"offset"+N,style:{width:"14.285%"},class:"offsets text-lightGrey text-opacity-60 flex items-center justify-center flex-shrink-0"},[r("div",Ue,C(w),1)]))),128)),(d(!0),c(V,null,A(e(b),(w,N)=>(d(),c("div",{key:"day"+N,style:{width:"14.285%"},class:B([[w.isDisabled?"text-lightGrey text-opacity-60":""],"flex items-center justify-center flex-shrink-0 p-1"])},[w.isDisabled?(d(),c("div",ze,C(w.date),1)):(d(),c("button",{key:0,"aria-label":"Tag auswählen",onClick:Z(E=>g(w.date),["stop"]),class:B(["hover:border hover:border-gold rounded-full w-full aspect-square",[e(l).selectedDate===new Date(e(l).year,e(l).month,w.date).setHours(0,0,0,0)?"bg-gold":""]])},C(w.date),11,Pe))],2))),128))])]),r("div",He,[e(l).selectedDate?(d(),c(V,{key:1},[e(l).timeslots.length===0?(d(),c(V,{key:0},[S(" Am "),r("span",We,C(new Date(e(l).selectedDate).toLocaleDateString("de-DE",{})),1),S(" stehen Ihnen leider keine freien Termine zur Verfügung. ")],64)):(d(),c(V,{key:1},[r("div",Je,[S(" Am "),r("span",Ze,C(new Date(e(l).selectedDate).toLocaleDateString("de-DE",{})),1),S(" stehen Ihnen folgende Termine zur Verfügung: ")]),r("div",Ke,[(d(!0),c(V,null,A(e(l).timeslots,(w,N)=>{var E,Q,z;return d(),c("button",{"aria-label":"Zeitslot auswählen",onClick:q=>i("selectTimeslot",{year:e(l).year,month:e(U),day:e(P),timeslot:w}),key:"timeslot"+N,class:B([[((E=o.selectedTimeslot)==null?void 0:E.month)===e(U)&&((Q=o.selectedTimeslot)==null?void 0:Q.day)===e(P)&&((z=o.selectedTimeslot)==null?void 0:z.timeslot)===w?"bg-gold":"hover:bg-gold"],"border border-gold rounded px-1 py-1 w-14 flex items-center justify-center"])},C(w),11,Ye)}),128))])],64))],64)):(d(),c("h2",Re,[S(" Hier können Sie ganz bequem über das Online Buchungstool einen Erst- oder Folgetermin buchen."),Ge,Qe,S(" Wählen Sie ein Datum und eine passende Uhrzeit aus. ")]))])])}}}),et={},tt={class:"w-full flex items-center px-4"},nt={class:"font-bold mr-2"},ot=r("div",{class:"border-b border-sand flex-grow"},null,-1);function lt(n,i){return d(),c("div",tt,[r("h2",nt,[pe(n.$slots,"default")]),ot])}const st=he(et,[["render",lt]]),Y=j({__name:"InputLabel",props:{label:null},setup(n){const i=n;return(o,a)=>(d(),c("div",{class:B(["text-xs font-bold ml-2",[{"mb-1":i.label}]])},C(i.label),3))}}),at={class:"bg-red bg-opacity-40 text-red text-sm mt-1 px-1 py-[2px] rounded"},X=j({__name:"InputError",props:{error:null},setup(n){const i=n;return(o,a)=>(d(),c("div",at,C(i.error),1))}});var ae;const ge=typeof window<"u",rt=n=>typeof n<"u",it=n=>typeof n=="function",ut=n=>typeof n=="string",dt=()=>{};ge&&((ae=window==null?void 0:window.navigator)!=null&&ae.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function _e(n){return typeof n=="function"?n():e(n)}function ct(n){return n}function mt(n){return we()?(xe(n),!0):!1}function ft(n){var i;const o=_e(n);return(i=o==null?void 0:o.$el)!=null?i:o}const pt=ge?window:void 0;function vt(...n){let i,o,a,x;if(ut(n[0])||Array.isArray(n[0])?([o,a,x]=n,i=pt):[i,o,a,x]=n,!i)return dt;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const t=[],D=()=>{t.forEach(v=>v()),t.length=0},k=(v,u,s,m)=>(v.addEventListener(u,s,m),()=>v.removeEventListener(u,s,m)),p=te(()=>[ft(i),_e(x)],([v,u])=>{D(),v&&t.push(...o.flatMap(s=>a.map(m=>k(v,s,m,u))))},{immediate:!0,flush:"post"}),f=()=>{p(),D()};return mt(f),f}function ht(n){return JSON.parse(JSON.stringify(n))}const re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ie="__vueuse_ssr_handlers__";re[ie]=re[ie]||{};var ue;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(ue||(ue={}));var gt=Object.defineProperty,de=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable,ce=(n,i,o)=>i in n?gt(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o,yt=(n,i)=>{for(var o in i||(i={}))_t.call(i,o)&&ce(n,o,i[o]);if(de)for(var o of de(i))bt.call(i,o)&&ce(n,o,i[o]);return n};const wt={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};yt({linear:ct},wt);function ee(n,i,o,a={}){var x,t,D;const{clone:k=!1,passive:p=!1,eventName:f,deep:v=!1,defaultValue:u}=a,s=Te(),m=o||(s==null?void 0:s.emit)||((x=s==null?void 0:s.$emit)==null?void 0:x.bind(s))||((D=(t=s==null?void 0:s.proxy)==null?void 0:t.$emit)==null?void 0:D.bind(s==null?void 0:s.proxy));let b=f;i||(i="modelValue"),b=f||b||`update:${i.toString()}`;const I=l=>k?it(k)?k(l):ht(l):l,M=()=>rt(n[i])?I(n[i]):u;if(p){const l=M(),F=ve(l);return te(()=>n[i],g=>F.value=I(g)),te(F,g=>{(g!==n[i]||v)&&m(b,g)},{deep:v}),F}else return $({get(){return M()},set(l){m(b,l)}})}const xt={class:"relative"},Tt={class:"w-full relative"},kt=["type","placeholder"],Dt={class:"absolute top-1/2 right-2 transform -translate-y-1/2"},$t={key:0,class:"bg-green bg-opacity-40 rounded"},St={key:1,class:"bg-red bg-opacity-40 rounded"},Vt=j({__name:"Input",props:{modelValue:null,label:null,innerClass:null,inputClass:{default:"pl-2 pr-10 py-1 w-full border border-grey rounded"},placeholder:null,validation:null,type:{default:"text"}},emits:["update:modelValue","update"],setup(n,{emit:i}){const o=n,a=L({touched:!1}),x=$(()=>{if(a.touched)return!(t.value.length>0)}),t=$(()=>{var f,v,u;let p=[];return a.touched&&((f=o.validation)!=null&&f.includes("required")&&(o.modelValue||p.push("Dieses Feld ist ein Pflichtfeld")),(v=o.validation)!=null&&v.includes("email")&&((u=o.modelValue)==null?void 0:u.includes("@"))===!1&&p.push("Bitte geben Sie eine gültige E-Mail-Adresse ein")),p}),D=()=>{a.touched=!0,i("update")},k=ee(o,"modelValue",i);return(p,f)=>{const v=Y,u=G,s=X;return d(),c("div",{class:B(n.innerClass)},[r("div",xt,[_(v,{label:o.label,class:"text-left"},null,8,["label"]),r("div",Tt,[R(r("input",{autocomplete:"disabled",type:n.type,placeholder:n.placeholder,class:B([o.inputClass,"fieldTarget"]),"onUpdate:modelValue":f[0]||(f[0]=m=>K(k)?k.value=m:null),onBlur:D},null,42,kt),[[ke,e(k)]]),r("div",Dt,[e(x)?(d(),c("div",$t,[_(u,{name:"icon-check",class:"text-green text-xl"})])):O("",!0),e(x)===!1?(d(),c("div",St,[_(u,{name:"icon-cross",class:"text-red text-xl"})])):O("",!0)])]),e(x)?O("",!0):(d(!0),c(V,{key:0},A(e(t),(m,b)=>(d(),c("div",{key:"error"+b},[_(s,{error:m},null,8,["error"])]))),128))])],2)}}}),It={class:"relative"},Mt={class:"w-full relative"},Ct=["value","selected"],Ot={class:"absolute top-1/2 right-5 transform -translate-y-1/2"},Ft={key:0,class:"bg-green bg-opacity-40 rounded"},Nt={key:1,class:"bg-red bg-opacity-40 rounded"},Et=j({__name:"InputSelect",props:{modelValue:null,label:null,options:null,innerClass:null,validation:null},emits:["update:modelValue","update"],setup(n,{emit:i}){const o=n,a=ee(o,"modelValue",i),x=L({touched:!1}),t=$(()=>{if(x.touched)return!(D.value.length>0)}),D=$(()=>{var f;let p=[];return x.touched&&(f=o.validation)!=null&&f.includes("required")&&(o.modelValue||p.push("Wählen Sie bitte eine Option")),p}),k=()=>{x.touched=!0,i("update")};return(p,f)=>{const v=Y,u=G,s=X;return d(),c("div",{class:B(n.innerClass)},[r("div",It,[_(v,{label:o.label,class:"text-left"},null,8,["label"]),r("div",Mt,[R(r("select",{onBlur:k,"onUpdate:modelValue":f[0]||(f[0]=m=>K(a)?a.value=m:null),onInput:f[1]||(f[1]=m=>i("update")),class:"fieldTarget w-full border border-grey rounded pl-2 pr-8 py-[6px]"},[(d(!0),c(V,null,A(o.options,(m,b)=>(d(),c("option",{key:"option"+b,value:m.value,selected:m.value===e(a)},C(m.label),9,Ct))),128))],544),[[De,e(a)]]),r("div",Ot,[e(t)?(d(),c("div",Ft,[_(u,{name:"icon-check",class:"text-green text-xl"})])):O("",!0),e(t)===!1?(d(),c("div",Nt,[_(u,{name:"icon-cross",class:"text-red text-xl"})])):O("",!0)])]),e(t)?O("",!0):(d(!0),c(V,{key:0},A(e(D),(m,b)=>(d(),c("div",{key:"error"+b},[_(s,{error:m},null,8,["error"])]))),128))])],2)}}}),Bt={class:"relative"},At={class:"w-full relative"},jt=["type","placeholder"],qt={class:"absolute top-2 right-2"},Lt={key:0,class:"bg-green bg-opacity-40 rounded"},Ut={key:1,class:"bg-red bg-opacity-40 rounded"},Pt=j({__name:"InputTextarea",props:{modelValue:null,label:null,innerClass:null,placeholder:null,validation:null,type:{default:"textarea"}},emits:["update:modelValue","update"],setup(n,{emit:i}){const o=n,a=L({touched:!1}),x=$(()=>{if(a.touched)return!(t.value.length>0)}),t=$(()=>{var f,v,u;let p=[];return a.touched&&((f=o.validation)!=null&&f.includes("required")&&(o.modelValue||p.push("Dieses Feld ist ein Pflichtfeld")),(v=o.validation)!=null&&v.includes("email")&&((u=o.modelValue)==null?void 0:u.includes("@"))===!1&&p.push("Bitte geben Sie eine gültige E-Mail-Adresse ein")),p}),D=()=>{a.touched=!0,i("update")},k=ee(o,"modelValue",i);return(p,f)=>{const v=Y,u=G,s=X;return d(),c("div",{class:B(n.innerClass)},[r("div",Bt,[_(v,{label:o.label,class:"text-left"},null,8,["label"]),r("div",At,[R(r("textarea",{autocomplete:"disabled",type:n.type,placeholder:n.placeholder,"onUpdate:modelValue":f[0]||(f[0]=m=>K(k)?k.value=m:null),onBlur:D,class:"fieldTarget w-full p-2 border border-grey rounded"},null,40,jt),[[$e,e(k)]]),r("div",qt,[e(x)?(d(),c("div",Lt,[_(u,{name:"icon-check",class:"text-green text-xl"})])):O("",!0),e(x)===!1?(d(),c("div",Ut,[_(u,{name:"icon-cross",class:"text-red text-xl"})])):O("",!0)])]),e(x)?O("",!0):(d(!0),c(V,{key:0},A(e(t),(m,b)=>(d(),c("div",{key:"error"+b},[_(s,{error:m},null,8,["error"])]))),128))])],2)}}}),zt=n=>(Ve("data-v-95f14d2d"),n=n(),Ie(),n),Ht={class:"relative"},Rt={class:"w-full relative"},Gt={class:"flex items-center gap-4"},Qt={class:"switch ml-02 my-01 flex-shrink-0"},Wt=zt(()=>r("span",{class:"slider"},null,-1)),Jt={class:"text-left text-sm flex-grow"},Zt=j({__name:"InputToggle",props:{modelValue:{type:[Boolean,null]},label:null,innerClass:null,validation:null},emits:["update:modelValue","update"],setup(n,{emit:i}){const o=n;let a=ee(o,"modelValue",i);const x=v=>{v.code==="Space"&&(console.log("space toggle"),a.value=!a.value)},t=L({touched:!1}),D=$(()=>{if(t.touched)return!(p.value.length>0)}),k=()=>{t.touched=!0,i("update")},p=$(()=>{var u;let v=[];return t.touched&&(u=o.validation)!=null&&u.includes("required")&&o.modelValue===!1&&v.push("Bitte bestätigen Sie dieses Feld"),v}),f=ve();return vt(f,"keyup",v=>{x(v)}),(v,u)=>{const s=Y,m=X;return d(),c("div",null,[r("div",{class:B(n.innerClass)},[r("div",Ht,[_(s,{label:o.label,class:"text-left"},null,8,["label"]),r("div",Rt,[r("div",Gt,[r("label",Qt,[R(r("input",{ref_key:"target",ref:f,type:"checkbox","onUpdate:modelValue":u[0]||(u[0]=b=>K(a)?a.value=b:a=b),onInput:u[1]||(u[1]=b=>i("update")),onBlur:k,class:"fieldTarget"},null,544),[[Se,e(a)]]),Wt]),r("div",Jt,[pe(v.$slots,"default",{},void 0,!0)])])])])],2),e(D)?O("",!0):(d(!0),c(V,{key:0},A(e(p),(b,I)=>(d(),c("div",{key:"error"+I},[_(m,{error:b},null,8,["error"])]))),128))])}}});const Kt=he(Zt,[["__scopeId","data-v-95f14d2d"]]),Yt={class:"flex flex-col items-center justify-center text-center"},Xt=r("div",{class:"mb-4"},"Sie haben folgenden Termin ausgewählt:",-1),en={class:"font-bold text-xl border-2 rounded border-gold inline-block px-4 py-1 mb-10"},tn=r("div",{class:"w-full lg:w-2/3 mb-10"}," Um Ihre Buchung abzuschließen, benötige ich noch ein paar Informationen von Ihnen. Füllen Sie bitte untenstehendes Formular aus. ",-1),nn=["onSubmit"],on=r("a",{href:"/datenschutz",target:"_blank",class:"underline"},"Datenschutzbestimmung",-1),ln={class:"flex justify-center w-full"},sn={"aria-label":"Termin buchen",type:"submit",class:"border-2 border-gold bg-gold rounded text-offwhite flex items-center px-3 py-2 mb-20"},an=r("div",{class:"text-coffee font-bold"},"Termin buchen",-1),rn={class:"flex items-center justify-center bg-white rounded-full ml-2 w-4 h-4"},un=j({__name:"BookingCalendarForm",props:{selectedTimeslot:null},emits:["formSubmitted"],setup(n,{emit:i}){const o=n,{pb:a}=me(),x=$(()=>o.selectedTimeslot?`${new Date(`${o.selectedTimeslot.year}-${o.selectedTimeslot.month}-${o.selectedTimeslot.day}`).toLocaleDateString("de-DE",{weekday:"short",year:"numeric",month:"numeric",day:"numeric"})} um ${o.selectedTimeslot.timeslot}`:void 0),t=L({form:{firstName:{value:void 0,validation:"required"},lastName:{value:void 0,validation:"required"},mail:{value:void 0,validation:"required|email"},phone:{value:void 0,validation:""},appointmentType:{value:void 0,validation:"required"},service:{value:void 0,validation:"required"},place:{value:void 0,validation:"required"},description:{value:void 0,validation:"required"},invoiceAddress:{value:void 0,validation:"required"},approvedCancellationConditions:{value:!1,validation:"required"},approvedDataprotection:{value:!1,validation:"required"}},success:!1,formSubmitted:!1,pending:!0}),D=()=>{{const u=document.querySelectorAll(".fieldTarget");for(const s of u)s.focus(),s.blur()}},k=$(()=>{let u=[];for(const s of Object.values(t.form))s.validation&&s.validation==="required"&&!s.value&&u.push("error");return u.length===0}),p=(u,s)=>{const m=s.split(":"),b=parseInt(m[0]),I=parseInt(m[1]);let M=new Date;M.setHours(b),M.setMinutes(I),M.setMinutes(M.getMinutes()+u);const l=M.getHours().toString().padStart(2,"0"),F=M.getMinutes().toString().padStart(2,"0");return l+":"+F},f=$(()=>{let u=[];for(const s of t.form.service.value)isNaN(parseInt(s))||u.push(s);return parseInt(u.join(""))}),v=async()=>{if(k.value){console.log("submitForm"),t.success=!1,t.formSubmitted=!1,t.pending=!0;try{const u={bookingType:"appointment",start:`${o.selectedTimeslot.year}-${o.selectedTimeslot.month}-${o.selectedTimeslot.day} ${o.selectedTimeslot.timeslot}:00.123Z`,end:`${o.selectedTimeslot.year}-${o.selectedTimeslot.month}-${o.selectedTimeslot.day} ${p(f.value,o.selectedTimeslot.timeslot)}:00.123Z`,firstName:t.form.firstName.value,lastName:t.form.lastName.value,mail:t.form.mail.value,phone:t.form.phone.value,appointmentType:t.form.appointmentType.value,service:t.form.service.value,place:t.form.place.value,description:t.form.description.value,invoiceAddress:t.form.invoiceAddress.value};console.log("data",u);const s=await a.collection("bookings").create(u);t.pending=!1,t.formSubmitted=!0,t.success=!0,i("formSubmitted",{success:!0,formValues:u})}catch(u){console.log("err",u),t.pending=!1,t.formSubmitted=!0,t.success=!1,i("formSubmitted",{success:!1,formValues:null})}}else D()};return fe(()=>{}),(u,s)=>{const m=st,b=Vt,I=Et,M=Pt,l=Kt,F=G;return d(),c("div",Yt,[Xt,r("div",en,C(e(x)),1),tn,r("form",{onSubmit:Z(v,["prevent"]),class:"w-full lg:w-2/3 flex flex-wrap -m-2"},[_(m,{class:"mb-4"},{default:W(()=>[S("Ihre Angaben")]),_:1}),_(b,{modelValue:e(t).form.firstName.value,"onUpdate:modelValue":s[0]||(s[0]=g=>e(t).form.firstName.value=g),label:"Vorname",placeholder:"Vorname",validation:e(t).form.firstName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),_(b,{modelValue:e(t).form.lastName.value,"onUpdate:modelValue":s[1]||(s[1]=g=>e(t).form.lastName.value=g),label:"Nachname",placeholder:"Nachname",validation:e(t).form.lastName.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),_(b,{modelValue:e(t).form.mail.value,"onUpdate:modelValue":s[2]||(s[2]=g=>e(t).form.mail.value=g),label:"E-Mail",placeholder:"E-Mail",validation:e(t).form.mail.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),_(b,{modelValue:e(t).form.phone.value,"onUpdate:modelValue":s[3]||(s[3]=g=>e(t).form.phone.value=g),label:"Telefonnummer (optional)",placeholder:"Telefonnummer",validation:e(t).form.phone.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","validation"]),_(I,{modelValue:e(t).form.appointmentType.value,"onUpdate:modelValue":s[4]||(s[4]=g=>e(t).form.appointmentType.value=g),options:e(ne).find(g=>g.type==="appointmentTypes").options,label:"Terminart",validation:e(t).form.appointmentType.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),_(I,{modelValue:e(t).form.service.value,"onUpdate:modelValue":s[5]||(s[5]=g=>e(t).form.service.value=g),options:e(ne).find(g=>g.type==="services").options,label:"Leistung",validation:e(t).form.service.validation,class:"p-2 w-full lg:w-1/2"},null,8,["modelValue","options","validation"]),_(I,{modelValue:e(t).form.place.value,"onUpdate:modelValue":s[6]||(s[6]=g=>e(t).form.place.value=g),options:[{label:"In meiner Praxis",value:"inPerson"},{label:"Online",value:"online"}],label:"Wo soll der Termin stattfinden?",validation:e(t).form.place.validation,class:"p-2 w-full lg:w-1/2 mb-8"},null,8,["modelValue","validation"]),_(m,{class:"mb-4"},{default:W(()=>[S("Terminvorbereitung")]),_:1}),_(M,{modelValue:e(t).form.description.value,"onUpdate:modelValue":s[7]||(s[7]=g=>e(t).form.description.value=g),label:"Beschreibung Ihres Themas",placeholder:"Bitte beschreiben Sie kurz Ihr Thema",validation:e(t).form.description.validation,class:"p-2 w-full"},null,8,["modelValue","validation"]),_(M,{modelValue:e(t).form.invoiceAddress.value,"onUpdate:modelValue":s[8]||(s[8]=g=>e(t).form.invoiceAddress.value=g),label:"Rechnungsadresse",placeholder:"Bitte tragen Sie die gewünschte Rechnungsadresse ein",validation:e(t).form.invoiceAddress.validation,class:"p-2 w-full mb-6"},null,8,["modelValue","validation"]),_(m,{class:"mb-4"},{default:W(()=>[S("Rechtliches")]),_:1}),_(l,{modelValue:e(t).form.approvedCancellationConditions.value,"onUpdate:modelValue":s[9]||(s[9]=g=>e(t).form.approvedCancellationConditions.value=g),class:"p-2 w-full",innerClass:"",validation:e(t).form.approvedCancellationConditions.validation},{default:W(()=>[S(" Ich habe verstanden, dass eine kostenlose Stornierung meines Termins bis zu 48 Stunden vor Terminbeginn möglich ist und dass danach eine Ausfallgebühr von 50% fällig wird. ")]),_:1},8,["modelValue","validation"]),_(l,{modelValue:e(t).form.approvedDataprotection.value,"onUpdate:modelValue":s[10]||(s[10]=g=>e(t).form.approvedDataprotection.value=g),class:"p-2 w-full mb-6",innerClass:"",validation:e(t).form.approvedDataprotection.validation},{default:W(()=>[S(" Ich habe die "),on,S(" gelesen und bin damit einverstanden. ")]),_:1},8,["modelValue","validation"]),r("div",ln,[r("button",sn,[an,r("div",rn,[_(F,{name:"icon-check",class:"text-sm text-coffee"})])])])],40,nn)])}}}),dn={class:"max-container"},cn={key:0,class:"flex justify-center my-20"},mn=r("div",{class:"w-full lg:w-2/3 font-bold border-2 rounded border-green bg-green bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[S(" Vielen Dank für Ihre Buchung. "),r("br"),S(" Ich melde mich zeitnah per E-Mail bei Ihnen. ")],-1),fn=[mn],pn={key:1,class:"flex justify-center my-20"},vn=r("div",{class:"w-full lg:w-2/3 font-bold border-2 rounded border-red bg-red bg-opacity-40 inline-block px-6 py-4 mb-10 text-center"},[S(" Bei der Übermittlung Ihrer Daten ist leider ein Fehler aufgetreten. "),r("br"),S("Versuchen Sie es bitte erneut. Sollte das Problem weiterhin bestehen, schreiben Sie mir bitte eine Mail an "),r("a",{href:"mailto:kontakt@eileengeorge.de",class:"underline"},"kontakt@eileengeorge.de"),S(". ")],-1),hn=[vn],gn={class:"flex items-center justify-center gap-10"},_n=["onClick"],kn=j({__name:"BookingCalendar",props:{component:null},setup(n){const i=n,{sendMail:o}=Ce(),a=L({currentStep:0,steps:[{id:0,name:"Terminfindung"},{id:1,name:"Buchung"}],selectedTimeslot:void 0,formValues:void 0,formSubmitted:!1,success:void 0}),x=p=>{a.selectedTimeslot=p,a.currentStep=1},t=p=>{if(p===0)return a.selectedTimeslot!=null;if(p===1)return a.formValues!=null},D=p=>{p===0&&(a.currentStep=0),p===1&&t(0)&&(a.currentStep=1)},k=async p=>{try{if(console.log("payload",p),p.success===!1)console.log("state.success = false;",a.success=!1),a.success=!1;else{console.log("state.success = true;",a.success=!0);const f={...p.formValues,timeslot:a.selectedTimeslot};console.log("formData",f),await o("bookingRequestUser",p.formValues.mail,f),await o("bookingRequestOwner","kontakt@eileengeorge.de",f),await o("bookingRequestOwner","alexbueckner@gmail.com",f),a.success=!0}a.formSubmitted=!0}catch(f){console.error("Error sending Mail",f)}};return(p,f)=>{const v=G,u=Xe,s=un;return d(),c("div",dn,[e(a).formSubmitted?(d(),c(V,{key:0},[e(a).success?(d(),c("div",cn,fn)):(d(),c("div",pn,hn))],64)):(d(),c(V,{key:1},[r("div",gn,[(d(!0),c(V,null,A(e(a).steps,(m,b)=>(d(),c("button",{"aria-label":"Schritt auswählen",onClick:I=>D(m.id),key:"step"+b,class:"flex flex-col gap-4 items-center justify-center w-1/3 py-10"},[r("div",{class:B([[e(a).currentStep===m.id?"bg-gold":"bg-darkOffwhite"],"w-full h-[5px] rounded relative"])},[r("div",{class:B([[e(a).currentStep===m.id?"bg-gradient-to-b from-gold via-lightGold to-darkGold":"bg-darkOffwhite"],"w-5 h-5 rounded-full absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"])},[t(m.id)?(d(),Me(v,{key:0,name:"icon-check",class:"text-xl"})):O("",!0)],2)],2),r("div",{class:B([[e(a).currentStep===m.id?"text-coffee font-bold":"text-lightGrey"],""])},C(m.name),3)],8,_n))),128))]),R(_(u,{onSelectTimeslot:x,component:i.component,selectedTimeslot:e(a).selectedTimeslot},null,8,["component","selectedTimeslot"]),[[se,e(a).currentStep===0]]),R(_(s,{onFormSubmitted:k,selectedTimeslot:e(a).selectedTimeslot},null,8,["selectedTimeslot"]),[[se,e(a).currentStep===1]])],64))])}}});export{kn as default};
